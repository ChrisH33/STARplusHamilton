// {{{ 2 "IncludeGuard" "PragmaOnce"
#pragma once
// }} ""
#include "HSL Liconic STX\\HSL Liconic STX.hsl"
#include "Training\\HSLTrcLib.hsl"
#include "HSLStrLib.hsl"
#include "HSLUtilLib.hsl"
#include "HSLFilLib.hsl"
#include "HSLMappingReport.hsl"
/* {{ 2 "LibraryInsertLine" "" */ // }} ""
// {{ 2 "TemplateIncludeBlock" ""
#include "HSLMETEDLib.hs_"
#include "Training\\HSLMECCLib.hs_"
// }} ""
// {{{ 2 "LibraryNamespace" "Begin"
namespace STXCAROUSELMANAGER {
// }} ""
/* {{ 2 "VariableInsertLine" "" */ // }} ""
// {{{ 2 "SubmethodForwardDeclaration" ""
private function CheckLiconicStatus(  ) void ;
function ClearDBData(  ) void ;
private function Definitions( variable & oDBFileName, variable & oDBTableName, variable & oUnitID, variable & oSTXTitle, variable & oSimulationState ) void ;
function GetBarcodedPlate( variable iBarcode, variable iRemovePlateFromExperiment ) void ;
function GetNewPlateFromPartition( variable iPartition, variable iRemovePlateFromExperiment ) variable ;
private function GetNonBarcodedPlate( variable iCassette, variable iShelf ) void ;
function GetPlateNoBarcode( variable iCassette, variable iShelf, variable iRemoveFromExperiment, variable & oBarcode ) void ;
function InitializeCarousel(  ) void ;
function InventoryCarousel(  ) void ;
function InventoryCarousel_Partial( variable Partition ) variable ;
private function InventoryCarousel_PartialTrueName( variable Partition ) variable ;
function InventoryCarousel_PartialVariableDelay( variable Partition, variable PartitionTime ) variable ;
function StoreNewPlate( variable iBarcode, variable & oCasette, variable & oShelf ) variable ;
function StoreNewPlateInPartition( variable iBarcode, variable iPartition ) void ;
function StorePlate( variable iBarcode, variable & oCassette, variable & oShelf ) void ;
function StorePlateAsInProcess( variable iBarcode, variable & oCassette, variable & oShelf ) void ;
function StorePlateAsUsed( variable iBarcode, variable & oCassette, variable & oShelf ) void ;
function TerminateCarousel(  ) void ;
function UpdateDatabaseFromArrays( variable iStackNumber, variable iPositionInStack, variable iBarcode, variable iPlateOccupancy ) void ;
// }} ""
function _InitLibrary() {
// {{ 2 "AutoInitBlock" ""
// }} ""
}
function _ExitLibrary() {
// {{ 2 "AutoExitBlock" ""
// }} ""
}
// {{{ 5 "GetBarcodedPlate" "Begin"
function GetBarcodedPlate( variable iBarcode, variable iRemovePlateFromExperiment ) void {
// }} ""
private variable myPlateStatus;
private variable myCassette;
private variable myBarcode;
private variable mySQLCommand;
private file LOOKUP_PLATE_POSITION_FILE;
private variable myFiileName;
private variable myIncubatorID;
private variable myTableName;
private variable myShelf;
private file REMOVE_BARCODE_FILE;
private variable level;
private variable slot;
private file UPDATE_STATUS_FILE;
private variable mySTXTitle;
private variable mySimState;
private variable tmpShelf;
private variable tmpCass;
private variable countError;
private variable dlgReturn;
private variable tmpBarcode;
private variable stepReturn;
private variable RetryReturn;
private variable loopIncubatorProblem;
private dialog dialogHandle61940AD21D1A43b2B9870489BC8DC471;
private dialog dialogHandleD00411E011474b4aB2A4F61ABDCAFC53;
private dialog dialogHandleDE31259E27E843b7BAB168F5DA7FC0DD;
private dialog dialogHandleCE40200BB7F040f694F2DF3C4DD230AC;
private dialog dialogHandle84AEA7EF08E7428696C7F0A2C02CDBB4;
// {{ 5 "GetBarcodedPlate" "InitLocals"
// }} ""
// {{ 68 1 0 "734dd1db_fbfc_4186_98cc52750cb16786" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************GetPlate Sub**************************************"));
// }} ""
// {{{ 69 1 0 "1102647d_7d0f_4a40_a6f60be28f7e61c6" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{ 70 1 0 "e25de2da_b55f_423b_b3223fa838b68c80" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 71 1 0 "f494e979_b556_419f_af601ead54a9b09b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myTableName, Translate("] WHERE [Barcode] = '"), iBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 72 1 0 "36c3c2a8_98df_4417_909dea1627c5c77d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
countError = 0;
while (1 == 1)
{
countError = countError + 1;
// }} ""
// {{ 73 1 0 "b95865d5_0eba_4b96_98c5bb3e681580b2" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LOOKUP_PLATE_POSITION_FILE.AddField("Cassette", myCassette, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Shelf", myShelf, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Barcode", myBarcode, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Status", myPlateStatus, hslString, 255);
if( 0 == LOOKUP_PLATE_POSITION_FILE.Open(myFiileName + " " + myTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 74 1 0 "e65df47f_2d76_4fea_b7e7df9aeeefab88" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_D0E82720E7B74420935DCA750A82B595 ;
err.Clear();
// }} ""
// {{ 75 1 0 "7e4b35a7_4ba2_40cd_83b74158bf0b7aca" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LOOKUP_PLATE_POSITION_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 76 1 0 "124bdcd6_6104_471a_816fd021c7138597" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 77 1 0 "9768890c_95c1_4f28_a9fb1062cd780cf3" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 78 1 0 "e65df47f_2d76_4fea_b7e7df9aeeefab88" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_D0E82720E7B74420935DCA750A82B595 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 79 1 0 "44f781e2_7e98_43be_adc9991b070901b4" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 80 1 0 "05b15ca6_60af_4ba0_b689fbbf3018fe75" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleCE40200BB7F040f694F2DF3C4DD230AC.SetOutput(Translate("The plate with barcode '"), iBarcode, Translate("' could not be found in incubator inventory!\nPlease place it onto the loading position and press OK afterwards."));
dlgReturn = dialogHandleCE40200BB7F040f694F2DF3C4DD230AC.ShowOutput(Translate("Barcode not found in Incubator Inventory"), hslOKCancel | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 81 1 0 "9928f8f0_33f3_4448_adeb33a086a80bf2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (dlgReturn == 2)
{
// }} ""
// {{ 82 1 0 "abfe7a86_3cdc_42ab_afef42af3185467d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 83 1 0 "273c8b5a_5dc1_4067_9be8b09d2c8adcc5" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 84 1 0 "9928f8f0_33f3_4448_adeb33a086a80bf2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 85 1 0 "9415ab4f_8eda_4f38_8cc0fbf5b50b6861" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 86 1 0 "a71c9343_21a2_417d_bc6bd134b660a6a5" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
StoreNewPlate(iBarcode, tmpCass, tmpShelf);
// }} ""
// {{ 87 1 0 "e65df47f_2d76_4fea_b7e7df9aeeefab88" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 88 1 0 "36c3c2a8_98df_4417_909dea1627c5c77d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 89 1 0 "12f02724_bb5a_4063_8a48c0ff75ec3491" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(myCassette);
// }} ""
// {{{ 90 1 0 "9eb3a238_6466_4cb6_b2fc855d252cdb3c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(myShelf);
// }} ""
// {{{ 91 1 0 "b4ba4470_bbc2_46bf_8e10b7e85c262faa" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 92 1 0 "c507f244_9438_413d_847c005ef3fbeacc" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Get Plate "), iBarcode, Translate(" started"));
// }} ""
// {{ 93 1 0 "4541373d_8ef2_4780_b4a62b16079b0735" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 94 1 0 "9b0a2436_7b9d_446e_96573c250abdb22f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myIncubatorID, slot, level, tmpBarcode);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 95 1 0 "0a9e8131_943c_4b7a_9b54af01cc0277e2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopIncubatorProblem = 0;
while (stepReturn == HSLLiconicSTX::FALSE)
{
loopIncubatorProblem = loopIncubatorProblem + 1;
// }} ""
// {{ 96 1 0 "973809b8_18d3_4ba6_973c343f82d9975d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopIncubatorProblem > 1)
{
// }} ""
// {{{ 97 1 0 "4e8f4245_e966_4d2d_808faa7433bd1b06" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::Terminate(myIncubatorID);
// }} ""
// {{ 98 1 0 "50df4a56_b267_4e45_8aea767dc03607d7" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle61940AD21D1A43b2B9870489BC8DC471.SetOutput(Translate("Check the incubator. \n\n  * * * * There has been "), loopIncubatorProblem, Translate(" failures!   * * * * \n\nOpen the door and check the plate to make sure it is in the correct location. \n Once you click 'Retry' it will Initialize and repeat this dialog forever. "));
RetryReturn = dialogHandle61940AD21D1A43b2B9870489BC8DC471.ShowOutput(Translate("STX 220 - Incubator Reading Problem"), hslRetryCancel | hslInformation | hslDefButton1, 30);
// }} ""
// {{{ 99 1 0 "8597cbb5_7475_45fb_b98da13dd23f6b21" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InitializeCarousel();
// }} ""
// {{ 100 1 0 "973809b8_18d3_4ba6_973c343f82d9975d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 101 1 0 "4c486be2_834b_481f_967b4877cbb0e369" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleDE31259E27E843b7BAB168F5DA7FC0DD.SetOutput(Translate("The incubator returned an error reading the Barcode!\n\nPlease check logfile for details."));
RetryReturn = dialogHandleDE31259E27E843b7BAB168F5DA7FC0DD.ShowOutput(Translate("Incubator Error"), hslRetryCancel | hslInformation | hslDefButton1, 30);
// }} ""
// {{ 102 1 0 "973809b8_18d3_4ba6_973c343f82d9975d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 103 1 0 "66fbb547_3e6e_4257_a3df1260843ffb41" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (RetryReturn == 2)
{
// }} ""
// {{ 104 1 0 "6194e477_b35f_4d64_949e63157d698180" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 105 1 0 "66fbb547_3e6e_4257_a3df1260843ffb41" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 106 1 0 "4194272b_0c68_47d7_b9e9d7e870f7c860" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myIncubatorID, slot, level, tmpBarcode);
// }} ""
// {{ 107 1 0 "0a9e8131_943c_4b7a_9b54af01cc0277e2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 108 1 0 "d649b7e7_23a0_46c2_87f7080bdc3f6f5a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("Barcode of plate read is ", tmpBarcode);
// }} ""
// {{{ 109 1 0 "6af88ed6_bea2_49ed_baf2002ab77331ee" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myIncubatorID, 2, slot, level, 1, 0, myIncubatorID, 1, 0, 0, 2, 0);
// }} ""
// {{ 110 1 0 "98780308_461b_4d77_9075afd6f7061350" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 111 1 0 "a2753cdb_454c_4750_acfc3b7d82533353" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleD00411E011474b4aB2A4F61ABDCAFC53.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandleD00411E011474b4aB2A4F61ABDCAFC53.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 112 1 0 "1c4a0546_8f34_42dd_a04609546b22c19b" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 113 1 0 "98780308_461b_4d77_9075afd6f7061350" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 114 1 0 "37b9de66_801f_4ca2_b6448b2011e0b0a0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (tmpBarcode != iBarcode)
{
// }} ""
// {{ 115 1 0 "3f614194_e7e0_4119_b923b0074a2470b4" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle84AEA7EF08E7428696C7F0A2C02CDBB4.SetOutput(Translate("The plate with barcode '"), iBarcode, Translate("' could not be found in incubator, possibly another one was found and has been unloaded!\nPlease place the right one onto the loading position and press OK afterwards."));
dlgReturn = dialogHandle84AEA7EF08E7428696C7F0A2C02CDBB4.ShowOutput(Translate("Plate not found in Incubator"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 116 1 0 "37b9de66_801f_4ca2_b6448b2011e0b0a0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 117 1 0 "4541373d_8ef2_4780_b4a62b16079b0735" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 118 1 0 "98b3d1b4_cca7_40e4_ab9d36074c4c4665" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 119 1 0 "ca016607_66c8_43e9_914b079980ac00a2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Get Plate "), iBarcode, Translate(" finished"));
// }} ""
// {{ 120 1 0 "501b8a3e_41d0_46eb_b7c82b40bd1c3c6b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (iRemovePlateFromExperiment == 1)
{
// }} ""
// {{{ 121 1 0 "902b4cb3_f5d3_40e1_a9c18778fc37cd91" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [Barcode] = NULL , [PlatePresent] = 0, [Status] = NULL WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 122 1 0 "91e5e383_024f_4c14_a8f487fcb5643a6e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == REMOVE_BARCODE_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 123 1 0 "b7d2f7be_5d4e_4242_84068e4abfa60e0b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != REMOVE_BARCODE_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
REMOVE_BARCODE_FILE.RemoveFields();
// }} ""
// {{{ 124 1 0 "68017d3b_d70a_4ea7_968501a94f5bdf04" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Plate "), iBarcode, Translate(" removed from inventory database"));
// }} ""
// {{ 125 1 0 "501b8a3e_41d0_46eb_b7c82b40bd1c3c6b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 126 1 0 "7f4da383_1920_40fc_9dfb89b21471f3a7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [PlatePresent] = 0, [Status] = 'STAR_DECK' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 127 1 0 "907208e0_c264_43c9_86f747e9a4a82040" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_STATUS_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 128 1 0 "4aa25035_cec0_488e_98aa90cfa1a5e8e3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_STATUS_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_STATUS_FILE.RemoveFields();
// }} ""
// {{{ 129 1 0 "5eac585f_7204_4d66_a7ac52e0f55a25fb" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Plate "), iBarcode, Translate(" status updated to \"STAR_DECK\""));
// }} ""
// {{ 130 1 0 "501b8a3e_41d0_46eb_b7c82b40bd1c3c6b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 131 1 0 "e25de2da_b55f_423b_b3223fa838b68c80" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 132 1 0 "e25de2da_b55f_423b_b3223fa838b68c80" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "GetBarcodedPlate" "End"
}
// }} ""
// {{{ 5 "Definitions" "Begin"
private function Definitions( variable & oDBFileName, variable & oDBTableName, variable & oUnitID, variable & oSTXTitle, variable & oSimulationState ) void {
// }} ""
// {{ 5 "Definitions" "InitLocals"
oDBFileName = 0;
oDBTableName = 0;
oUnitID = 0;
oSTXTitle = 0;
oSimulationState = 0;
// }} ""
// {{ 56 1 0 "b81ed245_9d75_43a8_974b42344ab40b7a" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 57 1 0 "ec24246c_0ca9_455c_8580afb95abe0e5d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oDBFileName = Translate("C:\\Program Files (x86)\\HAMILTON\\System\\MedImmune System Files\\MedImmune_STXManagment.mdb");
// }} ""
// {{ 58 1 0 "8f67ba56_9750_4c49_b5569c3bccf06f44" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oDBTableName = Translate("STXCarouselTable");
// }} ""
// {{ 59 1 0 "8cd0e217_6d26_4c47_bda864aa06e0ec2b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oUnitID = HSLLiconicSTX::UNIT_1;
// }} ""
// {{ 60 1 0 "5d99faeb_f7c6_4a28_b8c70abb63f70262" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oSTXTitle = Translate("STXCAROUSEL::");
// }} ""
// {{{ 61 1 0 "a83ec7d3_16e7_4e9a_ac8530e84f71fcea" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
oSimulationState = Util::GetSimulationMode();
// }} ""
// {{{ 62 1 0 "0009bbdf_87c9_4aff_bc7f0154ce9bbe48" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("oDBFileName = ", oDBFileName);
// }} ""
// {{{ 63 1 0 "4ed1e5b9_c203_4f13_9cf3aa8d916de663" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("oDBTableName = ", oDBTableName);
// }} ""
// {{{ 64 1 0 "52af2def_1b78_4876_b1f9bdbc80a2d9c8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("oUnitID = ", oUnitID);
// }} ""
// {{{ 65 1 0 "521f94ff_27af_4234_a6035bc99b500516" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("oSTXTitle = ", oSTXTitle);
// }} ""
// {{{ 66 1 0 "840aff56_aaf7_4561_bcc7dbc32b63752f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace("oSimulationState = ", oSimulationState);
// }} ""
// {{{ 5 "Definitions" "End"
}
// }} ""
// {{{ 5 "InventoryCarousel" "Begin"
function InventoryCarousel(  ) void {
// }} ""
private variable myDBFileName;
private variable myUnitID;
private variable myDBTableName;
private variable myInventoryFileName;
private file LICONIC_INV_FILE;
private variable myCassette;
private variable myBarcode;
private variable myShelf;
private variable shelf;
private variable cassette;
private file UPDATE_DB_INVENTORY_FILE;
private variable mySQLCommand;
private file READ_DB_INVENTORY_FILE;
private variable myStatus;
private variable myZeroBasedIndex;
private variable retValue;
private variable shelfInventoryArray[];
private variable barcodeToRemoveArray[];
private variable cassetteInventoryArray[];
private variable barcodeInventoryArray[];
private variable arrayIndex;
private variable myArraySize;
private variable mySTXTitle;
private timer timer1;
private variable mySimState;
private variable nullBarcode;
private variable myPPSensor;
private variable ppSensorArray[];
// {{ 5 "InventoryCarousel" "InitLocals"
// }} ""
// {{ 301 1 0 "0c21e7ca_8d86_4770_b06df301e767054d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************InventoryIncubator Sub**************************************"));
// }} ""
// {{{ 302 1 0 "d9d991ff_efea_479e_b074d6fea4388e17" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 303 1 0 "5ad8b068_c865_4814_b027160d248fa6aa" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
myInventoryFileName = Translate("C:\\Liconic Inventory Files\\STXCarousel_INV.txt");
// }} ""
// {{{ 304 1 0 "34300897_a787_45f7_880122884ffc459d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{{ 305 1 0 "a3f2dd7b_4487_4be1_9042fe054aa04ec1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 306 1 0 "d989d732_2514_4f97_846e3cdbf90a3343" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Inventory started"));
// }} ""
// {{ 307 1 0 "94e96dfd_513f_4799_a2f7072d7a313a78" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 308 1 0 "dd9f597e_210b_4e35_bf5374fdd74abc03" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::Inventory(myUnitID, myInventoryFileName, 1, 1);
// }} ""
// {{ 309 1 0 "5c53a0f8_0670_4075_beffb0a37bfe00d8" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.SetTimer(1200) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 310 1 0 "49ace68b_f682_4b7e_9fc8096cf24d4793" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.WaitTimer(hslTrue, hslTrue) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 311 1 0 "09417527_ad25_4573_9a26105085dd9522" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 312 1 0 "11a6bded_1393_4bc0_84c02b37782744cd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Inventory complete"));
// }} ""
// {{{ 313 1 0 "a00356b0_9fcb_418c_a30a1da2628abbba" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start update of inventory database"));
// }} ""
// {{ 314 1 0 "b15e0c13_be0e_4e9a_9c1988c386e66ed4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 315 1 0 "3e06ee41_4a53_4808_a12f76297f771cda" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 316 1 0 "352b8d01_654e_420b_a98a162a7d4d69da" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 317 1 0 "86090493_4153_4799_b4652b79d8d9924f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
ppSensorArray.SetSize(0);
// }} ""
// {{ 318 1 0 "7c4b2363_4145_4744_8208ded78078c42b" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 319 1 0 "11e45e33_b576_4057_afa6f3c1c4fe8397" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPPSensor, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 320 1 0 "0991d2f8_b11d_4f69_a1c8991c1e2dd0d1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 321 1 0 "ec58ead7_afad_4e17_a515efadb1d3ab06" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 322 1 0 "e7b15d00_2766_4e3a_b189cfcc94bba13d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 323 1 0 "7ebe1053_cf49_4343_93340384cb7d2b23" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
ppSensorArray.AddAsLast(myPPSensor);
// }} ""
// {{ 324 1 0 "275e5aba_e265_4273_960564c305e9bc8e" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 325 1 0 "77007b7e_3171_41c9_b1d208be8ebbdb5c" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 326 1 0 "a1db439d_27da_4eef_932f2734b4fd8309" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPPSensor == 1)
{
// }} ""
// {{ 327 1 0 "240660a1_8c20_41e8_a17f09f99dbca4dd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_7D343D2B08EF4b27AAF3B3A1331D1CA3 ;
err.Clear();
// }} ""
// {{ 328 1 0 "51c74094_c256_4a92_b9abbe4c75b2741f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "<null>")
{
// }} ""
// {{ 329 1 0 "64194978_0e78_4b9d_8432967b0cbc8422" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 330 1 0 "51c74094_c256_4a92_b9abbe4c75b2741f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 331 1 0 "d7ff287b_815d_410e_a4da5dc23af6187d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 332 1 0 "51c74094_c256_4a92_b9abbe4c75b2741f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 333 1 0 "240660a1_8c20_41e8_a17f09f99dbca4dd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_7D343D2B08EF4b27AAF3B3A1331D1CA3 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 334 1 0 "5bee9b07_757a_40fe_b2e7fd33525e6dc1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 335 1 0 "240660a1_8c20_41e8_a17f09f99dbca4dd" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 336 1 0 "5f423903_cea0_49da_9256df4bb533422b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 337 1 0 "b2617506_ac41_4ef2_b400664536a47903" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 338 1 0 "8a497978_dca9_434b_8f866f6aad1e195b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 339 1 0 "25497238_4f8f_4e5f_bd44ee6994020ba3" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 340 1 0 "726daa9f_7189_4926_8dd04671474e6e1b" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_4213BEB5C4B9414287BEA53828323185 ;
err.Clear();
// }} ""
// {{ 341 1 0 "e2b076db_fb3f_4b1a_bc6735036cfdd9fe" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 342 1 0 "7dfe1504_2646_4491_9ab7eee12b3a5061" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 343 1 0 "726daa9f_7189_4926_8dd04671474e6e1b" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_4213BEB5C4B9414287BEA53828323185 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 344 1 0 "5873ba0d_e615_4701_8e40f51526ac15ec" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 345 1 0 "bd845092_db19_4211_8153a2fe4ad5727b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 346 1 0 "f0948958_1066_4dfc_a8734d4efb302ca1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("', [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 347 1 0 "4c0151e2_ad93_439f_a443a6bb9eb4c1ab" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 348 1 0 "d2293884_1516_451c_853e9ed55c5e9413" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 349 1 0 "726daa9f_7189_4926_8dd04671474e6e1b" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 350 1 0 "5f423903_cea0_49da_9256df4bb533422b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 351 1 0 "97cdf057_6065_4469_b52e77e37f1d12b3" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 352 1 0 "21742626_549d_418a_992df072bc166aac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 353 1 0 "b05ec5ed_69c0_4570_b8a87a1f9cffcaca" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 354 1 0 "e6487168_31b0_4fc2_89023f3d22c0a8eb" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 355 1 0 "5f423903_cea0_49da_9256df4bb533422b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 356 1 0 "a1db439d_27da_4eef_932f2734b4fd8309" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 357 1 0 "149eab61_00cf_4bac_b070b98d8b6cf937" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 358 1 0 "2da3cde1_17d0_4e53_915cda9db78b20c8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = NULL WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 359 1 0 "49d9d1bf_0caa_43f9_a4ede37fc195adf0" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 360 1 0 "3445f85c_f308_4542_bd2e18383db754af" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 361 1 0 "a1db439d_27da_4eef_932f2734b4fd8309" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 362 1 0 "0991d2f8_b11d_4f69_a1c8991c1e2dd0d1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 363 1 0 "a55b6b15_ea1d_4a22_8f1951ce733c6487" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 364 1 0 "92af60e0_1227_4440_80487660a0a1399d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 365 1 0 "92716748_57be_4830_8b0bbdbfe2d596e4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE BARCODE IS NOT NULL"), Translate(""));
// }} ""
// {{ 366 1 0 "744a2901_3761_4610_9b3c4cd95e2cb0ed" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 367 1 0 "4cb07b9e_99ff_4bd0_9f28f1b2fb3d7848" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 368 1 0 "0f8ad375_569a_4ef4_8ba2ff21aaca98d2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_INVENTORY_FILE.Eof() == 0)
)
{
// }} ""
// {{ 369 1 0 "249c1d7c_018f_4915_94e63f38f7297f74" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 370 1 0 "2f9662de_0388_45bf_ac13bb336346410c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retValue = Util::Lookup(barcodeInventoryArray, myBarcode, myZeroBasedIndex);
// }} ""
// {{ 371 1 0 "581b6d78_56c2_4942_9bc66578b209fad9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retValue == 0)
{
// }} ""
// {{ 372 1 0 "7d17cdc9_3702_4757_8ab4adf366624fe6" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 373 1 0 "d18dbb5c_721c_483d_8f998b4126f02f50" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 374 1 0 "a1588970_6dd2_447b_9f1121a8f14e00d1" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 375 1 0 "d18dbb5c_721c_483d_8f998b4126f02f50" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 376 1 0 "581b6d78_56c2_4942_9bc66578b209fad9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 377 1 0 "0f8ad375_569a_4ef4_8ba2ff21aaca98d2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 378 1 0 "f369fcfb_0bba_4b31_92e0873394524e72" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 379 1 0 "2abe7638_b85c_4a40_a07b53f668845c71" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 380 1 0 "34d1cc6d_c1bd_46c9_96f621dec274ce69" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(arrayIndex = 0; arrayIndex < myArraySize;)
{
arrayIndex = arrayIndex + 1;
// }} ""
// {{ 381 1 0 "789fc720_db55_458a_8ec54a05716125ca" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 382 1 0 "87cfa233_27e7_4f58_8ae3e88d7108f326" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL, [PlatePresent] = 0 WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 383 1 0 "c3bebab7_4d1d_46c5_990995f577f2737f" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 384 1 0 "d979a3f5_62e9_4995_90b04a6b490fe524" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 385 1 0 "34d1cc6d_c1bd_46c9_96f621dec274ce69" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 386 1 0 "94e96dfd_513f_4799_a2f7072d7a313a78" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 387 1 0 "e9fb9474_6294_4770_a2f5db39c416fc12" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Inventory of incubator complete."));
// }} ""
// {{{ 5 "InventoryCarousel" "End"
}
// }} ""
// {{{ 5 "StorePlate" "Begin"
function StorePlate( variable iBarcode, variable & oCassette, variable & oShelf ) void {
// }} ""
private variable myPlateStatus;
private variable myBarcode;
private variable mySQLCommand;
private variable myFiileName;
private variable myIncubatorID;
private variable myTableName;
private file LOOKUP_PLATE_POSITION_FILE;
private variable level;
private variable slot;
private file UPDATE_STATUS_FILE;
private variable mySTXTitle;
private variable mySimState;
private variable stepReturn;
private dialog dialogHandleA4C6EA0A7E7A4012908E655E5DF3C27C;
private dialog dialogHandle9A839ACCBE18403dAD61F4D0B72FFB3F;
// {{ 5 "StorePlate" "InitLocals"
oCassette = 0;
oShelf = 0;
// }} ""
// {{ 1138 1 0 "5658f8ec_54cc_42c8_8c6a43886f60e0f5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************StorePlate Sub**************************************"));
// }} ""
// {{{ 1139 1 0 "b80e2d49_dbf5_46db_95dd4e5c72219f0f" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{ 1140 1 0 "023bf5d5_6d7d_4fc1_89f47b27c4c3d429" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1141 1 0 "a2d941f7_5e8a_4a33_9cd8b7b412b4b0db" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myTableName, Translate("] WHERE [Barcode] = '"), iBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1142 1 0 "b668191b_25ee_43b2_8aa01d25fa7dccb7" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LOOKUP_PLATE_POSITION_FILE.AddField("Cassette", oCassette, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Shelf", oShelf, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Barcode", myBarcode, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Status", myPlateStatus, hslString, 255);
if( 0 == LOOKUP_PLATE_POSITION_FILE.Open(myFiileName + " " + myTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1143 1 0 "1c1ac154_96a5_47f0_9eba15c83ff099de" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_F3279706664D49c383616547BB593FB9 ;
err.Clear();
// }} ""
// {{ 1144 1 0 "211d99f3_9eaf_4b6a_ab9707ae9abe6a7e" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LOOKUP_PLATE_POSITION_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1145 1 0 "b6733323_611e_4869_b4eb2791ac310126" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 1146 1 0 "1c1ac154_96a5_47f0_9eba15c83ff099de" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_F3279706664D49c383616547BB593FB9 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1147 1 0 "300e780b_a241_4f42_817b6d6d7dea99d4" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 1148 1 0 "11b177d9_8910_4435_97bb9f81832dadca" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle9A839ACCBE18403dAD61F4D0B72FFB3F.SetOutput(Translate("The plate with barcode '"), iBarcode, Translate("' could not be found in incubator inventory!\nYou cannot store back an unknown plate."));
dialogHandle9A839ACCBE18403dAD61F4D0B72FFB3F.ShowOutput(Translate("Barcode not found in Incubator Inventory"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 1149 1 0 "1008d8f5_dadc_4eb1_8f0bb4f7b88735b5" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1150 1 0 "1c1ac154_96a5_47f0_9eba15c83ff099de" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{{ 1151 1 0 "9494fab8_0afc_42e8_96f9bb359e93e208" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(oCassette);
// }} ""
// {{{ 1152 1 0 "d0488f8f_b3d7_454c_83857a9f536c002b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(oShelf);
// }} ""
// {{{ 1153 1 0 "1ed7bdd3_b40d_4486_be027c2c7d12d4ff" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1154 1 0 "b8d97b22_cac3_42e6_8d917317e3aabf52" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("Replacing Plate "), iBarcode, Translate(" in Cassette "), slot, Translate(", Shelf "), level, Translate(" started"));
// }} ""
// {{ 1155 1 0 "07e62885_50df_4646_a6bf2380d00114ff" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1156 1 0 "f44ff09d_a0e3_4f6d_ae3d05648c477b7a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myIncubatorID, 1, 0, 0, 2, 0, myIncubatorID, 2, slot, level, 1, 0);
// }} ""
// {{ 1157 1 0 "287ad5f9_634a_4eaa_9b8fad8cb596e47d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1158 1 0 "bac1ae5a_3640_493f_b5bcdf199b50420c" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleA4C6EA0A7E7A4012908E655E5DF3C27C.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandleA4C6EA0A7E7A4012908E655E5DF3C27C.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1159 1 0 "865f8ac7_66fc_4c58_ad32ed8fdcf6351d" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1160 1 0 "287ad5f9_634a_4eaa_9b8fad8cb596e47d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1161 1 0 "07e62885_50df_4646_a6bf2380d00114ff" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1162 1 0 "2b7a2906_3cd1_4b66_909f91699e578d83" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1163 1 0 "004ca3fe_9a6d_4aa0_8739de26c2d97c3a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Replace Plate "), iBarcode, Translate(" complete"));
// }} ""
// {{{ 1164 1 0 "1c0010e6_da27_4a50_bbcdb7cc9a8f7dd4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [PlatePresent] = 1, [Status] = 'INCUBATOR' WHERE [Cassette] = '"), oCassette, Translate("' AND [Shelf] = '"), oShelf, Translate("'"), Translate(""));
// }} ""
// {{ 1165 1 0 "f2e25ed7_ad58_4206_a147a8c78beb298e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_STATUS_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1166 1 0 "8452a641_19d4_4a70_a4d9a3a94f3bc703" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_STATUS_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_STATUS_FILE.RemoveFields();
// }} ""
// {{ 1167 1 0 "023bf5d5_6d7d_4fc1_89f47b27c4c3d429" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1168 1 0 "28f42a8e_2936_4c37_807d0c78e1f9b515" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oCassette = 1;
// }} ""
// {{ 1169 1 0 "2cdcd26a_5d95_40ff_87ab6e4b13c7f4b9" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oShelf = 1;
// }} ""
// {{ 1170 1 0 "023bf5d5_6d7d_4fc1_89f47b27c4c3d429" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "StorePlate" "End"
}
// }} ""
// {{{ 5 "InitializeCarousel" "Begin"
function InitializeCarousel(  ) void {
// }} ""
private variable myUnitID;
private variable myTableName;
private variable myFileName;
private variable mySTXTitle;
private variable User_choice;
private variable loopCounter3;
private variable loopCounter4;
private timer timer1;
private variable STX_STATUS;
private variable mySimState;
private variable STX_returnSTATUS;
private dialog dialogHandleF066D284675D445f85D302C3B3E1B5A5;
private variable new_WarningStatus;
private variable new_GateClosedStatus;
private variable new_ErrorCodeStatus;
private variable new_PlateReady;
private variable new_SysInitialized;
private variable new_SysReady;
private variable new_UserDoorStatus;
private variable new_XferStatStatus;
// {{ 5 "InitializeCarousel" "InitLocals"
// }} ""
// {{ 230 1 0 "a379603d_44da_4982_a5e095e77ee096f4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************InitializeIncubator Sub**************************************"));
// }} ""
// {{{ 231 1 0 "f318b4c6_e7ac_4a40_a4b22d26c828abdc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFileName, myTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{{ 232 1 0 "e3dfd886_3696_49bd_9561d60c29506372" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Initialize start"));
// }} ""
// {{ 233 1 0 "a111f866_9e2a_4713_bdc886fb97154a85" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState == 0)
{
// }} ""
// {{ 234 1 0 "67469921_26f3_45fe_9816a48bce384bef" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 235 1 0 "63186dd0_39a2_439b_ac157800ca1aabd9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::FALSE);
// }} ""
// {{ 236 1 0 "a111f866_9e2a_4713_bdc886fb97154a85" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 237 1 0 "b5df9a6a_4a40_441e_87a57cb1120fef12" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 238 1 0 "71e25a56_4277_4d74_881e9ed3bdf4aedd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::TRUE);
// }} ""
// {{ 239 1 0 "a111f866_9e2a_4713_bdc886fb97154a85" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 240 1 0 "435d9b72_7cca_47a2_b30f208e35015fdf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::GetSysStatus(myUnitID, STX_STATUS, new_SysReady, new_PlateReady, new_SysInitialized, new_XferStatStatus, new_GateClosedStatus, new_UserDoorStatus, new_WarningStatus, new_ErrorCodeStatus);
// }} ""
// {{{ 241 1 0 "73536504_aa0d_4b7e_8fc1709e78356218" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Initialize: New SysReady - "), new_SysReady);
// }} ""
// {{ 242 1 0 "397f4455_98d3_4fd8_9605df54f4b2dcb2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter4 = 0;
while (new_SysReady != HSLLiconicSTX::TRUE)
{
loopCounter4 = loopCounter4 + 1;
// }} ""
// {{ 243 1 0 "27d77fc5_4a13_4ba6_90d3220a8b2c5c7c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState == 0)
{
// }} ""
// {{ 244 1 0 "0699ef0b_96ac_450f_ad00dec881c6b442" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 245 1 0 "efd12f02_c469_4f6c_978eeecc810b8eb2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::FALSE);
// }} ""
// {{ 246 1 0 "27d77fc5_4a13_4ba6_90d3220a8b2c5c7c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 247 1 0 "117c6821_3664_49e2_a6c14a64724ff25b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 248 1 0 "48ce6776_b3c8_4878_b4c74f73e5cf893f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::TRUE);
// }} ""
// {{ 249 1 0 "27d77fc5_4a13_4ba6_90d3220a8b2c5c7c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 250 1 0 "fe0d73ba_8bce_49d4_b1aba400b4b0e46f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Initialize after 1st Init: STX_returnSTATUS = "), STX_returnSTATUS);
// }} ""
// {{ 251 1 0 "c6b52e78_789d_47db_8e469e53fd8d7df0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (STX_returnSTATUS == HSLLiconicSTX::FALSE)
{
// }} ""
// {{{ 252 1 0 "003955a3_c763_4fd7_9fa4d95c5296b620" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::GetSysStatus(myUnitID, STX_STATUS, new_SysReady, new_PlateReady, new_SysInitialized, new_XferStatStatus, new_GateClosedStatus, new_UserDoorStatus, new_WarningStatus, new_ErrorCodeStatus);
// }} ""
// {{{ 253 1 0 "5d6d18ad_5872_4c48_b5c8895f16236b53" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("StatusCode:  "), STX_STATUS, Translate(""));
// }} ""
// {{ 254 1 0 "57395b28_cdc5_4a8e_9695c2fe96b701b6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (new_SysReady == HSLLiconicSTX::TRUE)
{
// }} ""
// {{ 255 1 0 "de022434_86dc_4349_b30885f02a7f0cf4" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 256 1 0 "57395b28_cdc5_4a8e_9695c2fe96b701b6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 257 1 0 "0ef4ea3a_b2c4_45e1_b2af209f2d0182ee" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState == 1)
{
// }} ""
// {{ 258 1 0 "737bc9b7_ea99_4c71_a32f65acf192c989" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 259 1 0 "e28559ee_afa3_4c5f_9d0c9f4081bb7ac4" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 260 1 0 "0ef4ea3a_b2c4_45e1_b2af209f2d0182ee" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 261 1 0 "ca743ea5_339a_4ff8_a5eb14bf0f650754" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (new_SysReady != HSLLiconicSTX::TRUE)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{{ 262 1 0 "f82beec4_8f20_4abb_a2130c4f3ced5c18" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::GetSysStatus(myUnitID, STX_STATUS, new_SysReady, new_PlateReady, new_SysInitialized, new_XferStatStatus, new_GateClosedStatus, new_UserDoorStatus, new_WarningStatus, new_ErrorCodeStatus);
// }} ""
// {{{ 263 1 0 "4b763664_44cb_422d_bc2cc25ea3a033a7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("StatusCode:  "), STX_STATUS, Translate(""));
// }} ""
// {{ 264 1 0 "4804483c_870e_4f83_a58c847542259f39" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.SetTimer(3) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 265 1 0 "83e8365a_99c9_4ab7_860f9b7eb145ba70" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.WaitTimer(hslFalse, hslFalse) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 266 1 0 "deff4089_610b_4d8a_9dfdecdfaa64b138" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (new_SysReady == 39)
{
// }} ""
// {{ 267 1 0 "656b7bb9_d496_4ff0_81f59d119babc2ab" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 268 1 0 "deff4089_610b_4d8a_9dfdecdfaa64b138" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 269 1 0 "6b13b051_7702_4ef8_a4a13b68326bc9f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounter3 > 5)
{
// }} ""
// {{ 270 1 0 "906d3fbb_ddb7_448c_8da84d929dbdc4da" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 271 1 0 "6b13b051_7702_4ef8_a4a13b68326bc9f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 272 1 0 "ca743ea5_339a_4ff8_a5eb14bf0f650754" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 273 1 0 "57395b28_cdc5_4a8e_9695c2fe96b701b6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 274 1 0 "36ad851c_3e12_4a0e_a071c640d8702311" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (new_SysInitialized == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 275 1 0 "f4b920c2_244c_4be0_bf2385a02e889a8b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounter4 == 2)
{
// }} ""
// {{{ 276 1 0 "d52a87ae_42c4_4505_883ddf4fc9819983" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::Terminate(myUnitID);
// }} ""
// {{ 277 1 0 "2a925e0e_73c2_4e5e_ae4522fe316f3336" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleF066D284675D445f85D302C3B3E1B5A5.SetOutput(Translate("Incubator is not initializing.  What do you want to do?"));
User_choice = dialogHandleF066D284675D445f85D302C3B3E1B5A5.ShowOutput("", hslRetryCancel | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 278 1 0 "dae247b7_72ee_4e45_95f53307379b15f9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (User_choice == 2)
{
// }} ""
// {{ 279 1 0 "778714ac_15ab_426b_930c2dd874b86814" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 280 1 0 "dae247b7_72ee_4e45_95f53307379b15f9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 281 1 0 "6a3e1b75_2e6a_4e19_8fc65f93199f91c2" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 282 1 0 "aa87953b_0ffd_404d_93562402eace6cde" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState == 0)
{
// }} ""
// {{ 283 1 0 "ebc12578_033a_43c2_a33b610b2f15ae84" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 284 1 0 "3a823018_ff00_44f6_874ca8df61f3991a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::FALSE);
// }} ""
// {{ 285 1 0 "aa87953b_0ffd_404d_93562402eace6cde" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 286 1 0 "f069efe2_f04a_49bc_816dfa949a73f1d5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 287 1 0 "e5b6c6d6_bad2_410f_82f96bcfac034735" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
STX_returnSTATUS = HSLLiconicSTX::Initialize(myUnitID, "localhost", 3336, HSLLiconicSTX::TRACE_LEVEL_FULL, HSLLiconicSTX::TRUE);
// }} ""
// {{ 288 1 0 "aa87953b_0ffd_404d_93562402eace6cde" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 289 1 0 "1e3a77d6_e401_4e1a_be31ed43e441351d" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.SetTimer(30) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 290 1 0 "9157ff13_f17a_40f9_9253290d391d8fb7" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.WaitTimer(hslFalse, hslFalse) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 291 1 0 "fcc02537_797a_4e3a_be276bec3fa9d03f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
loopCounter4 = 1;
// }} ""
// {{ 292 1 0 "f4b920c2_244c_4be0_bf2385a02e889a8b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 293 1 0 "36ad851c_3e12_4a0e_a071c640d8702311" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 294 1 0 "c6b52e78_789d_47db_8e469e53fd8d7df0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 295 1 0 "9f5d7e78_98d1_4bdd_a319d0e6efdbfe8f" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 296 1 0 "0caeae6b_50fe_47e8_838c97457a0356bc" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::WriteSetClimate(myUnitID, 4, 65, 0, 0);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 297 1 0 "c6b52e78_789d_47db_8e469e53fd8d7df0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 298 1 0 "397f4455_98d3_4fd8_9605df54f4b2dcb2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 299 1 0 "bf075df8_fd91_4eb1_a7004573975b860f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Initialize finished"));
// }} ""
// {{{ 5 "InitializeCarousel" "End"
}
// }} ""
// {{{ 5 "CheckLiconicStatus" "Begin"
private function CheckLiconicStatus(  ) void {
// }} ""
private variable STX_STATUS;
private variable myUnitID;
private variable myTableName;
private variable myFileName;
private variable mySTXTitle;
private variable loopCounter3;
private timer timer1;
private variable mySimState;
private variable new_WarningStatus;
private variable new_GateClosedStatus;
private variable new_ErrorCodeStatus;
private variable new_PlateReady;
private variable new_SysInitialized;
private variable new_SysReady;
private variable new_UserDoorStatus;
private variable new_XferStatStatus;
// {{ 5 "CheckLiconicStatus" "InitLocals"
// }} ""
// {{ 1 1 0 "187c680e_7a8a_418b_914beb91426291eb" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************CheckLiconicStatus Sub**************************************"));
// }} ""
// {{{ 2 1 0 "eed5de12_6baa_43d0_af48560bea157333" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFileName, myTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 3 1 0 "2358c671_2a20_4ca5_8e4ed618b656b388" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 4 1 0 "00331c40_2e34_4cfc_af7f0dc04b36749b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::GetSysStatus(myUnitID, STX_STATUS, new_SysReady, new_PlateReady, new_SysInitialized, new_XferStatStatus, new_GateClosedStatus, new_UserDoorStatus, new_WarningStatus, new_ErrorCodeStatus);
// }} ""
// {{ 5 1 0 "2358c671_2a20_4ca5_8e4ed618b656b388" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 6 1 0 "3fa22369_105b_4360_a77b08b07deab7de" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return;
// }} ""
// {{ 7 1 0 "2358c671_2a20_4ca5_8e4ed618b656b388" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 8 1 0 "d15b68c3_7b5c_45d5_8c0a9e0e6129d8d4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Check Liconic Status Before Loop: new_SysReady = "), new_SysReady);
// }} ""
// {{ 9 1 0 "0b0d9a43_40f6_4ac9_b33b1a53d6aae270" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter3 = 0;
while (new_SysReady != HSLLiconicSTX::TRUE)
{
loopCounter3 = loopCounter3 + 1;
// }} ""
// {{{ 10 1 0 "d8f3efcb_a772_4025_b4e4d362f12fc3f7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Check Liconic Status Top of Loop: new_SysReady = "), new_SysReady);
// }} ""
// {{{ 11 1 0 "87d6c256_ccea_4b98_830c48d8296ce458" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::GetSysStatus(myUnitID, STX_STATUS, new_SysReady, new_PlateReady, new_SysInitialized, new_XferStatStatus, new_GateClosedStatus, new_UserDoorStatus, new_WarningStatus, new_ErrorCodeStatus);
// }} ""
// {{ 12 1 0 "bbfe718f_8db7_4098_8dde8acb595deea6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (new_SysInitialized != HSLLiconicSTX::TRUE)
{
// }} ""
// {{{ 13 1 0 "4e10fe81_73d9_453a_a8760bad0f8251cd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InitializeCarousel();
// }} ""
// {{ 14 1 0 "bbfe718f_8db7_4098_8dde8acb595deea6" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 15 1 0 "1887ae82_7c0f_4cab_941f2fe5a102f9f5" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.SetTimer(3) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 16 1 0 "77e51b7b_6fb3_4a54_a44e26230aa78b53" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == timer1.WaitTimer(hslFalse, hslFalse) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 17 1 0 "495e7569_1281_441b_a048582b3b10f13c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (new_SysReady == HSLLiconicSTX::TRUE)
{
// }} ""
// {{ 18 1 0 "4ea25efd_a764_45b3_b09b04cebd147656" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 19 1 0 "495e7569_1281_441b_a048582b3b10f13c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 20 1 0 "be0c5119_09b1_47e4_9f42ff2ea27bdbfd" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Check Liconic Status End of Loop: new_SysReady = "), new_SysReady);
// }} ""
// {{ 21 1 0 "0b0d9a43_40f6_4ac9_b33b1a53d6aae270" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 5 "CheckLiconicStatus" "End"
}
// }} ""
// {{{ 5 "TerminateCarousel" "Begin"
function TerminateCarousel(  ) void {
// }} ""
private variable myDBFileName;
private variable myUnitID;
private variable myDBTableName;
private variable mySTXTitle;
private variable mySimState;
private dialog dialogHandleD20B41662EB34d07B81D4C6BB8E6F148;
private variable stepReturn;
// {{ 5 "TerminateCarousel" "InitLocals"
// }} ""
// {{ 1238 1 0 "742fbe6d_ab3f_4cfa_9b818c08cc23ba99" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************TerminateIncubator Sub**************************************"));
// }} ""
// {{{ 1239 1 0 "2870113b_2efa_4e77_8b3cd64d4c3f68f4" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{{ 1240 1 0 "914e5501_4ca0_4564_8498ae75918237b7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Termination started"));
// }} ""
// {{{ 1241 1 0 "82e689ce_7aba_4ecc_8bbb5955550ed66a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::Terminate(myUnitID);
// }} ""
// {{ 1242 1 0 "fa169ccc_49ef_4d4c_9951c553d9701225" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1243 1 0 "6bde51b5_e29d_44f9_8b4c0e821c7f9d74" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleD20B41662EB34d07B81D4C6BB8E6F148.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandleD20B41662EB34d07B81D4C6BB8E6F148.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1244 1 0 "d4e56989_3bc5_497e_a8411e92d838bcf4" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1245 1 0 "fa169ccc_49ef_4d4c_9951c553d9701225" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1246 1 0 "c75bc466_b2db_4a07_87968655aa415a52" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Termination finished"));
// }} ""
// {{{ 5 "TerminateCarousel" "End"
}
// }} ""
// {{{ 5 "ClearDBData" "Begin"
function ClearDBData(  ) void {
// }} ""
private variable myCassette;
private variable myDBFileName;
private variable myShelf;
private variable myUnitID;
private variable myDBTableName;
private variable mySQLCommand;
private file READ_DB_FILE;
private variable myCassetteArray[];
private variable myShelfArray[];
private variable myIndex;
private variable myArraySize;
private file UPDATE_DB_FILE;
private variable mySTXTitle;
private variable mySimState;
// {{ 5 "ClearDBData" "InitLocals"
// }} ""
// {{ 23 1 0 "58a8c78a_5111_4a76_bbc18dedd1183c0b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************ClearDBData Sub**************************************"));
// }} ""
// {{{ 24 1 0 "a46068b5_2c49_4bd5_b1e1314cf8d07f0a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{{ 25 1 0 "88ae1720_0eae_4a2c_bbdf34f81f3e4d94" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start cleanup of inventory database"));
// }} ""
// {{ 26 1 0 "a1f0c294_0a46_4121_8e4f37d4a94949d0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 27 1 0 "53b990b6_273d_481f_909b06021c15b2d6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NOT NULL"), Translate(""));
// }} ""
// {{ 28 1 0 "7a4a80c0_7e64_4c7b_846be0a8b63ebcb0" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_FILE.AddField("Shelf", myShelf, hslString, 255);
if( 0 == READ_DB_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 29 1 0 "fa41c7b2_fa7f_4ff7_aa7c41f13ba0a14a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
myCassetteArray.SetSize(0);
// }} ""
// {{ 30 1 0 "93a42db1_61ac_4537_af581930397f5fec" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
myShelfArray.SetSize(0);
// }} ""
// {{ 31 1 0 "ba3b5897_91aa_465f_8a640dcf627eafae" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_FILE.Eof() == 0)
)
{
// }} ""
// {{ 32 1 0 "3417022c_100e_48c7_af1db3fd5e912719" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 33 1 0 "6c938b98_f5b3_4f2f_85b424111cd70c7c" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
myCassetteArray.AddAsLast(myCassette);
// }} ""
// {{ 34 1 0 "c769fb4f_c9ce_4470_8788a45438d80e36" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
myShelfArray.AddAsLast(myShelf);
// }} ""
// {{ 35 1 0 "ba3b5897_91aa_465f_8a640dcf627eafae" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 36 1 0 "c07b7779_06a0_4a75_9a8ea84ad6623b89" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_FILE.RemoveFields();
// }} ""
// {{{ 37 1 0 "75f36857_bb78_46c8_a1becb9260f927ab" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [PlatePresent] =1"), Translate(""));
// }} ""
// {{ 38 1 0 "28f0d457_dd81_4afb_9445021629926b6b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_FILE.AddField("Shelf", myShelf, hslString, 255);
if( 0 == READ_DB_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 39 1 0 "adbb3e06_17f7_4c19_9332bee03b4c80bb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_FILE.Eof() == 0)
)
{
// }} ""
// {{ 40 1 0 "da1bbb5b_da34_4dd2_a111f9ca0fbd2e14" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 41 1 0 "276376ff_8a99_48e6_8581c5ad18120958" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
myCassetteArray.AddAsLast(myCassette);
// }} ""
// {{ 42 1 0 "3b49d82a_8676_42d7_9a19dee1bf950aaf" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
myShelfArray.AddAsLast(myShelf);
// }} ""
// {{ 43 1 0 "adbb3e06_17f7_4c19_9332bee03b4c80bb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 44 1 0 "6ac8a4da_712c_43ac_91eca29f4d02b394" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_FILE.RemoveFields();
// }} ""
// {{ 45 1 0 "cf5ee428_5662_433b_baa2679b921af16d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 46 1 0 "471f0a93_583f_4d57_b9fb93e19453f5a1" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=myCassetteArray.GetSize();
// }} ""
// {{ 47 1 0 "b563661f_b25d_4c9a_a59c274bcde57a65" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myIndex = 0; myIndex < myArraySize;)
{
myIndex = myIndex + 1;
// }} ""
// {{ 48 1 0 "5e00f771_397c_4ea6_9b94694226f7d68b" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myCassette=myCassetteArray.GetAt(myIndex-1);
// }} ""
// {{ 49 1 0 "b734951b_eef9_407e_83d8a78975ecdde6" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myShelf=myShelfArray.GetAt(myIndex-1);
// }} ""
// {{{ 50 1 0 "799dd653_26df_4036_990fba2f9ad28b93" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [PlatePresent] = 0, [Status] = NULL WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 51 1 0 "42174a3a_439d_4510_93c85c07df3faca6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 52 1 0 "15d4fb7f_07ed_44ee_854ddb10ac56e73a" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_FILE.RemoveFields();
// }} ""
// {{ 53 1 0 "b563661f_b25d_4c9a_a59c274bcde57a65" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 54 1 0 "cf1a3ca6_c6c8_408d_9c4fffb44427ab3e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Finished cleanup of inventory database"));
// }} ""
// {{{ 5 "ClearDBData" "End"
}
// }} ""
// {{{ 5 "StoreNewPlate" "Begin"
function StoreNewPlate( variable iBarcode, variable & oCasette, variable & oShelf ) variable {
// }} ""
private variable myDBFileName;
private variable level;
private variable myUnitID;
private variable myDBTableName;
private variable slot;
private variable mySQLCommand;
private file DB_LOOKUP_FILE;
private variable retVal;
private file DB_UPDATE_FILE;
private variable mySTXTitle;
private variable mySimState;
private variable retval;
private variable tmpBarcode;
private variable dlgReturn;
private variable loopCounter1;
private variable stepReturn;
private dialog dialogHandleCCE33968D0F9400aB42F2332810EE160;
private variable oCassette;
private dialog dialogHandleA075A5682BEC4cd891A867FF410D7993;
private dialog dialogHandle24BD2BE2D6524137905611141509E261;
private dialog dialogHandleA2AFBCBF11C94953B43B819B4ECE6860;
private dialog dialogHandle82042AAAA28547d989445AEC70F14077;
private dialog dialogHandle564D4E1EE59B47ed975A18CD92074C64;
private dialog dialogHandleA711E33626804f36A1505ABDC74E8D11;
private dialog dialogHandle0B7C5CAAA7F14e588BA503A0CF182758;
// {{ 5 "StoreNewPlate" "InitLocals"
oCasette = 0;
oShelf = 0;
// }} ""
// {{ 992 1 0 "30f8acd2_983a_4176_89f9f865c6288d85" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************StoreNewPlate Sub**************************************"));
// }} ""
// {{{ 993 1 0 "df09bb3b_0b34_42bc_9d1569eb3db41db1" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 994 1 0 "014cf3e8_f741_4917_a1956358a661fe14" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 995 1 0 "db673d2f_3364_4011_ae9b82a9a305883f" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 996 1 0 "705336e9_4710_437d_8973c6aaa6e7cdf2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NULL"), Translate(""));
// }} ""
// {{ 997 1 0 "67d424ae_cd84_4913_b14f81e8d3cfc567" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
DB_LOOKUP_FILE.AddField("Cassette", oCassette, hslString, 255);
DB_LOOKUP_FILE.AddField("Shelf", oShelf, hslString, 255);
if( 0 == DB_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 998 1 0 "7de10c19_5896_48b5_b026568f5c97cc38" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_84823D38D1A946d885273983DC4B38CD ;
err.Clear();
// }} ""
// {{ 999 1 0 "5e528829_6697_40f3_8e088a24341fc483" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1000 1 0 "7de10c19_5896_48b5_b026568f5c97cc38" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_84823D38D1A946d885273983DC4B38CD : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1001 1 0 "35b7918c_e6bd_444e_ac4de40559507cf3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 1002 1 0 "187779ea_eea4_4b3e_a108d95c96242a6d" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleCCE33968D0F9400aB42F2332810EE160.SetOutput(Translate("There is no place left to store the current plate in the incubator as it is full."));
dialogHandleCCE33968D0F9400aB42F2332810EE160.ShowOutput(Translate("Incubator's limit exceeded"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1003 1 0 "5696cbbb_f709_46c8_ab1b5b53424603ee" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1004 1 0 "7de10c19_5896_48b5_b026568f5c97cc38" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 1005 1 0 "25d0eb25_fbbe_44f1_bc91ea9386453f14" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 1006 1 0 "15f64a04_3e39_4d75_a186ff7ed88e0988" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1007 1 0 "8d4de2ab_fefa_4221_a4aa918a8b8e51de" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(oCassette);
// }} ""
// {{{ 1008 1 0 "5bde006f_3210_43f4_b9e830d39dd8ad15" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(oShelf);
// }} ""
// {{{ 1009 1 0 "e70e2572_ac92_4faa_b075886cf8b360b3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1010 1 0 "d973e8e7_de7c_4ca8_a145e933e98723e6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start storage of new plate"));
// }} ""
// {{ 1011 1 0 "aef95138_ed0d_4e04_b730f1f39ddcaee6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (1 == 1)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{{ 1012 1 0 "5fa6501a_412b_4e64_8b967119aad4e324" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myUnitID, 1, 0, 0, 2, 0, myUnitID, 2, slot, level, 1, 0);
// }} ""
// {{ 1013 1 0 "969f9e14_924f_48c7_be58019c1971cad1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1014 1 0 "9c52218e_dc16_421c_a3e297edb8e8169b" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleA711E33626804f36A1505ABDC74E8D11.SetOutput(Translate("The incubator returned an error moving the plate!\nPlease check logfile for details."));
dialogHandleA711E33626804f36A1505ABDC74E8D11.ShowOutput(Translate("Incubator Error moving plate Store New plate"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 1015 1 0 "55d08f46_f43e_471b_8feacf339625ec93" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1016 1 0 "969f9e14_924f_48c7_be58019c1971cad1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1017 1 0 "8aec2886_2a11_49db_9181370acb43a1cd" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{ 1018 1 0 "0025d0e4_5547_4fa6_9b9a24cbc0a363b7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (iBarcode == "")
{
// }} ""
// {{ 1019 1 0 "e98b5651_a7ea_49c9_a2fcb746995a515b" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 1020 1 0 "ada5b820_9a02_4e03_b167e506d01c4c28" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1021 1 0 "3d20e468_98dc_44ad_aca440b8c60684da" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retVal = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, iBarcode);
// }} ""
// {{ 1022 1 0 "ada5b820_9a02_4e03_b167e506d01c4c28" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1023 1 0 "40c88192_9409_4d87_9b6c85db0d395389" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandleA075A5682BEC4cd891A867FF410D7993.SetInputSize(1);
dialogHandleA075A5682BEC4cd891A867FF410D7993.SetInputField(0, Translate("Plate Barcode"), hslString, "");
dialogHandleA075A5682BEC4cd891A867FF410D7993.ShowInput(Translate("Liconic Simulation Barcode Entry"), hslInfinite, hslOKOnly | hslDefButton1);
iBarcode = dialogHandleA075A5682BEC4cd891A867FF410D7993.GetInputField(0);
// }} ""
// {{ 1024 1 0 "04071176_6532_4e27_9778050414812ede" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
retval = HSLLiconicSTX::TRUE;
// }} ""
// {{ 1025 1 0 "ada5b820_9a02_4e03_b167e506d01c4c28" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1026 1 0 "2ed32f5d_cf68_482a_88803f9902e5a861" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{ 1027 1 0 "d57930cc_50d8_4f77_a3ef9c1ab011e68b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retVal == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1028 1 0 "b82ceeb3_5264_487f_bf62377d4ff3acdd" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1029 1 0 "135908d5_8b8b_422c_8a6e29d8cc738b74" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retVal = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, iBarcode);
// }} ""
// {{ 1030 1 0 "07f3417f_abac_4446_8ab12ff50f28dab0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retVal == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1031 1 0 "5c2284ce_2959_44d0_be42285249a75719" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle24BD2BE2D6524137905611141509E261.SetOutput(Translate("LICONIC STX220 WARNING!!!"), Translate("\n\n The Barcode on the plate in Slot "), oCassette, Translate(", Level "), oShelf, Translate(" could not be read."), Translate("\nPlease check the barcode of this plate so it can be entered manually."), Translate("\n\nHit 'OK' to proceed to enter the plate barcode"));
dialogHandle24BD2BE2D6524137905611141509E261.ShowOutput(Translate("Liconic STX 220 Barcode Warning"), hslOKOnly | hslQuestion | hslDefButton1, hslInfinite);
// }} ""
// {{ 1032 1 0 "4be48b34_18a1_4c64_b3a415ac1d410f1d" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandleA2AFBCBF11C94953B43B819B4ECE6860.SetInputSize(1);
dialogHandleA2AFBCBF11C94953B43B819B4ECE6860.SetInputField(0, Translate("Plate Barcode"), hslString, "");
dialogHandleA2AFBCBF11C94953B43B819B4ECE6860.ShowInput(Translate("Liconic STX 220 Barcode Entry"), hslInfinite, hslOKOnly | hslDefButton1);
iBarcode = dialogHandleA2AFBCBF11C94953B43B819B4ECE6860.GetInputField(0);
// }} ""
// {{ 1033 1 0 "07f3417f_abac_4446_8ab12ff50f28dab0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1034 1 0 "d57930cc_50d8_4f77_a3ef9c1ab011e68b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1035 1 0 "ff9fdfa4_110b_419d_87d6627d782e878b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myUnitID, 2, slot, level, 2, 0, myUnitID, 1, 0, 0, 1, 0);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1036 1 0 "0025d0e4_5547_4fa6_9b9a24cbc0a363b7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1037 1 0 "4bab89df_3e48_4c71_941c16cdbb1dceb1" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 1038 1 0 "a16faf25_a609_4ef8_87a16da5e355e5be" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, tmpBarcode);
// }} ""
// {{ 1039 1 0 "aeeac90a_e0f5_46f5_92bca2bb3ee100e5" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle82042AAAA28547d989445AEC70F14077.SetOutput(tmpBarcode);
dialogHandle82042AAAA28547d989445AEC70F14077.ShowOutput(Translate("temp Barcode"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1040 1 0 "6210b5c4_b536_453f_aca2c153cdb3581f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (tmpBarcode != iBarcode)
{
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 1041 1 0 "b7ff1d40_8d82_4127_8c8198eb6cdce85f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myUnitID, 2, slot, level, 2, 0, myUnitID, 1, 0, 0, 1, 0);
// }} ""
// {{ 1042 1 0 "5e8930d8_f92c_4080_b6eadeed31a7ea00" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1043 1 0 "c987ffe0_9eec_4b11_aa358e912e7e2828" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle564D4E1EE59B47ed975A18CD92074C64.SetOutput(Translate("The incubator returned an error reading the barcode!\nPlease check logfile for details."));
dialogHandle564D4E1EE59B47ed975A18CD92074C64.ShowOutput(Translate("Incubator Error Barcode error in Store New Plate"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1044 1 0 "3b0f6c0d_e768_4209_808838396b210bfd" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1045 1 0 "5e8930d8_f92c_4080_b6eadeed31a7ea00" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1046 1 0 "6b4be283_75fe_465b_9c0c7d1f9385b236" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle0B7C5CAAA7F14e588BA503A0CF182758.SetOutput(Translate("The plate with barcode '"), tmpBarcode, Translate("' does not match the expected barcode '"), iBarcode, Translate("'!\nPlease replace it on the loading position and press OK afterwards."));
dlgReturn = dialogHandle0B7C5CAAA7F14e588BA503A0CF182758.ShowOutput(Translate("Wrong plate detected"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1047 1 0 "6210b5c4_b536_453f_aca2c153cdb3581f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1048 1 0 "e5c21d26_73e9_4f9c_a653853c3c88a15d" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1049 1 0 "6210b5c4_b536_453f_aca2c153cdb3581f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1050 1 0 "0025d0e4_5547_4fa6_9b9a24cbc0a363b7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1051 1 0 "aef95138_ed0d_4e04_b730f1f39ddcaee6" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1052 1 0 "6f39621d_3513_43ec_84404bc36d7b9afd" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1053 1 0 "acebf7a1_a1e4_4585_aed931f574723bc2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (iBarcode != "")
{
// }} ""
// {{{ 1054 1 0 "0fb4504c_bb4a_4cfd_95923db8b01275b5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), iBarcode, Translate("' , [PlatePresent] = 1, [Status] = 'INCUBATOR' WHERE [Cassette] = '"), oCassette, Translate("' AND [Shelf] = '"), oShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1055 1 0 "acebf7a1_a1e4_4585_aed931f574723bc2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1056 1 0 "d8be659f_7b45_446e_b2b0c70b584eba5e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1057 1 0 "d53bc855_0ac0_4371_aa4c5acec12841e3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = 1, [Status] = 'INCUBATOR' WHERE [Cassette] = '"), oCassette, Translate("' AND [Shelf] = '"), oShelf, Translate(""), Translate(""), Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1058 1 0 "acebf7a1_a1e4_4585_aed931f574723bc2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1059 1 0 "9b4105cf_2f36_424e_b4a6d760f378d09b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_UPDATE_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1060 1 0 "ddc34cff_fb47_4bc1_a8d54e8e8fd09ef2" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_UPDATE_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_UPDATE_FILE.RemoveFields();
// }} ""
// {{{ 1061 1 0 "1dfb124d_c881_4b9e_a177b4d6e5218eb0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("Plate "), iBarcode, Translate(" stored in Cassette "), slot, Translate(", Shelf "), level, Translate(" succesfully"));
// }} ""
// {{ 1062 1 0 "014cf3e8_f741_4917_a1956358a661fe14" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1063 1 0 "fdf62222_1670_41eb_b2b69d41ce5798df" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (iBarcode);
// }} ""
// {{{ 5 "StoreNewPlate" "End"
}
// }} ""
// {{{ 5 "InventoryCarousel_Partial" "Begin"
function InventoryCarousel_Partial( variable Partition ) variable {
// }} ""
private variable shelf;
private variable myCassette;
private variable cassette;
private variable mySTXTitle;
private variable myBarcode;
private variable myDBFileName;
private variable myInventoryFileName;
private variable myShelf;
private variable myArraySize;
private variable myUnitID;
private variable myArrayIndex;
private variable myDBTableName;
private variable myStatus;
private variable mySQLCommand;
private file READ_DB_INVENTORY_FILE;
private file LICONIC_INV_FILE;
private file UPDATE_DB_INVENTORY_FILE;
private variable shelfInventoryArray[];
private variable nullCassetteArray[];
private variable barcodeToRemoveArray[];
private variable nullShelfArray[];
private variable cassetteInventoryArray[];
private variable barcodeInventoryArray[];
private variable arrayIndex;
private variable mySimState;
private variable stepReturn;
private timer PartialInventoryTimer_Unit1;
private variable myInventoryFileNameCheck;
private variable PartitionTime;
private variable loopCounterFileCheck;
private variable newEntry(0);
private variable myPlate;
private variable plateInventoryArray[];
private dialog dialogHandleDE1FC7D74FEE47738629342C32F84870;
private variable myPlatesTotal(0);
private variable nullBarcode;
private dialog dialogHandle423DC797D9934646A39B4CB84CF2011C;
private dialog dialogHandle7421224604D14552BB7A83945D5A5C69;
private dialog dialogHandle06575CD083984abaB3FC2E924A4B55CC;
private variable liconicPartition;
private variable partitionCounter;
private variable numOfPartitions;
private variable myZeroBasedIndex;
private variable myPPSensor;
private variable retValue;
private file PARTITION_NAME_LOOKUP_FILE;
private variable arrLiconicPartitions[];
private variable ppSensorArray[];
// {{ 5 "InventoryCarousel_Partial" "InitLocals"
// }} ""
// {{ 389 1 0 "02b74342_8418_4fc9_8e659264297ecfcd" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************InventoryIncubator_Partial Sub**************************************"));
// }} ""
// {{{ 390 1 0 "1381a219_7f42_4fb8_a3fb0f5f8f6c1b45" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 391 1 0 "0d0b7a6c_a18d_4335_bc867025c02a2448" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PartitionTime = 120;
// }} ""
// {{ 392 1 0 "3b2e6ef8_29b4_4539_9a882e920b888f90" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
myInventoryFileName = Translate("C:\\Liconic Inventory Files\\STXCarousel_PARTIAL_INV.txt");
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 393 1 0 "5f506820_c413_448f_8f3980a39642d5c3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 394 1 0 "f7c66017_7129_4e5f_a57e9d85f71bf39c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myInventoryFileName == myInventoryFileNameCheck)
{
// }} ""
// {{{ 395 1 0 "aceb868c_61ac_44fa_95c95c92771dca47" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 396 1 0 "f7c66017_7129_4e5f_a57e9d85f71bf39c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 397 1 0 "ee949f47_d9db_4280_a71ef68258bd8e63" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 398 1 0 "d203295d_9c34_4508_97fab809972aa326" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" started"));
// }} ""
// {{ 399 1 0 "df09a7cc_d858_4629_a306d7f6687256d4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 400 1 0 "de049e33_15af_439d_a54e8a7f243adfc3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT DISTINCT [LiconicPartition] FROM ["), myDBTableName, Translate("] WHERE [Partition] = '"), Partition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 401 1 0 "8ad62f46_563e_4ffe_b6d17c29c4a462f7" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
PARTITION_NAME_LOOKUP_FILE.AddField("LiconicPartition", liconicPartition, hslString, 255);
if( 0 == PARTITION_NAME_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 402 1 0 "c44cfba5_82f5_44e0_aab7915c6694e584" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
arrLiconicPartitions.SetSize(0);
// }} ""
// {{ 403 1 0 "c485ffa3_1ca7_400e_9eade25b590e17ed" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (PARTITION_NAME_LOOKUP_FILE.Eof() == 0)
)
{
// }} ""
// {{ 404 1 0 "de2c0fa4_3817_4882_b99600b5fb099a75" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PARTITION_NAME_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 405 1 0 "58afbba2_7c91_45f4_aea4c6db0a339899" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
arrLiconicPartitions.AddAsLast(liconicPartition);
// }} ""
// {{ 406 1 0 "c485ffa3_1ca7_400e_9eade25b590e17ed" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 407 1 0 "9e80eea5_c294_4cd8_9a89aba1c18c9b09" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != PARTITION_NAME_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
PARTITION_NAME_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 408 1 0 "fec5e13c_adf6_47f5_bf86049113d19364" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 409 1 0 "d5d1b3a9_b9b1_4b7d_94ef46a1345fd7ba" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
numOfPartitions=arrLiconicPartitions.GetSize();
// }} ""
// {{ 410 1 0 "d54ad365_08ca_4197_86b089c7744409d5" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(partitionCounter = 0; partitionCounter < numOfPartitions;)
{
partitionCounter = partitionCounter + 1;
// }} ""
// {{{ 411 1 0 "1cf73199_66cf_42c7_82be9d759b8db147" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 412 1 0 "6a774583_4bf7_4023_b491b74633704029" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
liconicPartition=arrLiconicPartitions.GetAt(partitionCounter-1);
// }} ""
// {{{ 413 1 0 "d21b3e6d_4d5c_44cc_b8bc39ee2c7b753b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::PartialInventoryScan(myUnitID, myInventoryFileName, liconicPartition, 1, 1);
// }} ""
// {{ 414 1 0 "57bd54bf_eb81_4a3a_90139a5ee4177ab1" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.SetTimer(PartitionTime) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 415 1 0 "c06a10ce_2acc_46de_b7d8a963023ae7ef" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 416 1 0 "0d92b359_8d56_415b_a32aadc52307085b" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle7421224604D14552BB7A83945D5A5C69.SetOutput(Translate("The incubator returned an error!\n\nPlease check logfile for details."));
dialogHandle7421224604D14552BB7A83945D5A5C69.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 417 1 0 "d23fa73b_9b28_41fa_9deafba8948df69c" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 418 1 0 "c06a10ce_2acc_46de_b7d8a963023ae7ef" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 419 1 0 "3d9016d6_2e2e_4e6e_8d46116ad03f1aa2" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.WaitTimer(hslTrue, hslTrue) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 420 1 0 "8c5a32ac_53b6_4c9f_ada8dcf054092ab0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 421 1 0 "8ef871ab_559a_4bb0_87805cd83914a639" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounterFileCheck = 0;
while (myInventoryFileName != myInventoryFileNameCheck)
{
loopCounterFileCheck = loopCounterFileCheck + 1;
// }} ""
// {{ 422 1 0 "8ec34c01_7c70_4406_ba7e108581cef8dc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 200)
{
// }} ""
// {{ 423 1 0 "f4d5db02_4135_4531_8bcd11c43c2ae0fb" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle423DC797D9934646A39B4CB84CF2011C.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not completing.... \n\n\n ABORT and run again......"));
dialogHandle423DC797D9934646A39B4CB84CF2011C.ShowOutput(Translate("STX220 Invenoty Write File Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 424 1 0 "3e5e85fd_54a1_49f5_81eb35befbeacc54" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 425 1 0 "8ec34c01_7c70_4406_ba7e108581cef8dc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 426 1 0 "3b4d494b_97da_4dd0_84de7c8c0e0f4887" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 20)
{
// }} ""
// {{ 427 1 0 "afd8e719_8e56_470d_aca8879d49e56f2c" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle06575CD083984abaB3FC2E924A4B55CC.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not complete.... \n\n\n Delay 20 sec......"));
dialogHandle06575CD083984abaB3FC2E924A4B55CC.ShowOutput(Translate("STX220 Invenoty Delay "), hslOKOnly | hslInformation | hslDefButton1, 20);
// }} ""
// {{ 428 1 0 "3b4d494b_97da_4dd0_84de7c8c0e0f4887" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 429 1 0 "8ec34c01_7c70_4406_ba7e108581cef8dc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 430 1 0 "5276c7cf_cd8f_4233_bffe6e619d815db7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 431 1 0 "8ef871ab_559a_4bb0_87805cd83914a639" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 432 1 0 "da6bb0fc_7137_450f_889cd22627002b11" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 433 1 0 "8c56d6e1_b33a_483c_b0a85f9d7c7f4253" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" complete"));
// }} ""
// {{{ 434 1 0 "f54db7f6_792f_4b39_8708272826200499" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start update of inventory database"));
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 435 1 0 "fa3c51dc_0b3d_42ad_a43755dd2edf6992" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 436 1 0 "ba371130_8273_4bfe_8e612db62603ba53" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 437 1 0 "16fcf725_b964_4fab_a08f39e2925ad8d5" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 438 1 0 "b5b52349_27a0_450e_9454a8f5a9205816" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 439 1 0 "ee2efc55_d90a_453f_933cc041c9ab62ed" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
plateInventoryArray.SetSize(0);
// }} ""
// {{ 440 1 0 "50abc051_8d29_4d3d_843108aa504c30c1" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPlate, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 441 1 0 "c99cd3cf_57ca_49ad_aba2ab7ee2acee76" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 442 1 0 "3cfe5bc6_930e_42a7_bf65a947c6d7f10d" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 443 1 0 "e642dda5_effc_4b19_8c5b7f0e0452d9ea" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 444 1 0 "202a4bcc_d627_4eb3_87854c3ea9519406" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 445 1 0 "a07422ba_ba42_4b17_b8cba6f645b4cec2" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 446 1 0 "f2807d0f_4072_4cc6_b4242af8bd458533" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 447 1 0 "ac72fdfc_cbac_40fe_8575c71118daba9f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullCassetteArray.SetSize(0);
// }} ""
// {{ 448 1 0 "59090719_b74e_41b1_b2fd50516705a625" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
plateInventoryArray.AddAsLast(myPlate);
// }} ""
// {{ 449 1 0 "adf258fd_ed99_4356_8f63e864cbffbaff" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullShelfArray.SetSize(0);
// }} ""
// {{ 450 1 0 "3d827324_51b4_4e0b_adee721b4167151e" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
myPlatesTotal = myPlatesTotal + myPlate;
// }} ""
// {{ 451 1 0 "c66588d4_277c_4351_a42bb958b3481629" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_A5FF4A02A7244249870A8DCCE9E24F07 ;
err.Clear();
// }} ""
// {{ 452 1 0 "e2fda735_e068_4789_a9e57de37d18a047" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 453 1 0 "9d2b4cf0_c4f2_4d9a_980b9e5b0a62d5d4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 454 1 0 "e2fda735_e068_4789_a9e57de37d18a047" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 455 1 0 "e05ad042_749c_4e53_b9f17f808369b7e1" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 456 1 0 "e2fda735_e068_4789_a9e57de37d18a047" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 457 1 0 "c66588d4_277c_4351_a42bb958b3481629" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_A5FF4A02A7244249870A8DCCE9E24F07 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 458 1 0 "7890744c_604f_439d_955367c115544d8b" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 459 1 0 "c66588d4_277c_4351_a42bb958b3481629" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 460 1 0 "0b3a6f11_a420_4897_8a5479708b765572" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 461 1 0 "acbeb18f_0ad0_4ec5_8e2aef3fc4529ed5" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 462 1 0 "07eff53e_dbde_45c1_add17bb6c9edb79c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 463 1 0 "10485e8c_e8d9_4c6d_bc252d4f2ab460e1" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 464 1 0 "aba4af7d_96c5_4746_a9325811eb36da27" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_68E4F510C724451a8FE16CC885993CDE ;
err.Clear();
// }} ""
// {{ 465 1 0 "910089fb_c61c_4af1_8d5d436e681f8ac3" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 466 1 0 "d7abce24_df80_43b8_a32423c36a453f91" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 467 1 0 "aba4af7d_96c5_4746_a9325811eb36da27" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_68E4F510C724451a8FE16CC885993CDE : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 468 1 0 "ebc765e1_e9e5_4c18_a7b654c1a4151ea1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 469 1 0 "412b9784_896b_4494_800b3826d47c3b67" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 470 1 0 "c47aaab6_a11c_40cc_b267d9b6c9448661" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("' , [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 471 1 0 "6ece9d52_0020_47d4_b4a785170966b42e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 472 1 0 "cd364c56_952d_4293_b07d63720cfe1e14" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 473 1 0 "1c3e0de3_26fd_4564_89bca2800ad08d37" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
newEntry = newEntry + 1;
// }} ""
// {{ 474 1 0 "aba4af7d_96c5_4746_a9325811eb36da27" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 475 1 0 "0b3a6f11_a420_4897_8a5479708b765572" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 476 1 0 "99688351_50d7_4dd1_a70d5250fcf9497a" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullCassetteArray.AddAsLast(myCassette);
// }} ""
// {{ 477 1 0 "4617fd6e_58eb_44ba_821cf59b3cd7d761" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullShelfArray.AddAsLast(myShelf);
// }} ""
// {{ 478 1 0 "0b3a6f11_a420_4897_8a5479708b765572" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 479 1 0 "c99cd3cf_57ca_49ad_aba2ab7ee2acee76" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 480 1 0 "aafd287d_6420_4357_a7ffd974da32b739" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 481 1 0 "89d9fb47_40d0_4759_b957e53f21db46e4" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 482 1 0 "5f28d6cc_7957_4d41_a2b13d0dd9a511da" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=nullCassetteArray.GetSize();
// }} ""
// {{ 483 1 0 "717e6d12_0c98_4046_b1c21be276febb7d" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 484 1 0 "6ba4f902_3f6c_407a_bf1bb6da07043c9d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 485 1 0 "0222b529_16ad_49b7_9f162ca68beccf99" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myCassette=nullCassetteArray.GetAt(myArrayIndex-1);
// }} ""
// {{ 486 1 0 "2ac071fa_387c_4263_b17fba1bf881b06f" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myShelf=nullShelfArray.GetAt(myArrayIndex-1);
// }} ""
// {{{ 487 1 0 "7e081716_9b41_4e7b_94828489b7439707" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 488 1 0 "06bbbb7c_dd9a_429d_a296bfc43c75481b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 489 1 0 "b87216cf_ff14_49dc_b4553249c61169e1" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 490 1 0 "3d11772d_f2ad_45fa_83143420378a8d86" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 491 1 0 "3d921c38_3358_47a5_89c22d92d7fef13a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_587E4418274E4ca7892BD290649B067B ;
err.Clear();
// }} ""
// {{ 492 1 0 "e643a0c4_4a16_4f03_97f8dda00ba0ae29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 493 1 0 "ff21b6ef_e4fb_46cd_b88041fcfee17490" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 494 1 0 "e643a0c4_4a16_4f03_97f8dda00ba0ae29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 495 1 0 "72deab05_6ee8_4de1_bef66fd622ed94ed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 496 1 0 "72deab05_6ee8_4de1_bef66fd622ed94ed" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 497 1 0 "3d921c38_3358_47a5_89c22d92d7fef13a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_587E4418274E4ca7892BD290649B067B : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 498 1 0 "659febf1_9376_4755_873d5bed94256341" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Error handled by system"), Translate(""));
// }} ""
// {{ 499 1 0 "3d921c38_3358_47a5_89c22d92d7fef13a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 500 1 0 "6ba4f902_3f6c_407a_bf1bb6da07043c9d" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 501 1 0 "dfda0595_dd95_4576_9c66a75d2ffbd960" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 502 1 0 "eefcb6c7_c9b8_40c4_8d50524731ecd889" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 503 1 0 "1e5b27ad_2f7d_4420_94894811f592a998" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 504 1 0 "22404f00_ea0b_4a94_abb6edb3126843ef" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 505 1 0 "e6dacf6e_3941_46d6_b8faf682072d7302" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 506 1 0 "9d7d08c7_218e_4bff_bc4fa272fbe7ebaf" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 507 1 0 "eefcb6c7_c9b8_40c4_8d50524731ecd889" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 508 1 0 "92ca4e14_bb18_4a3e_8f4edc46e14db2f1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 509 1 0 "9c5551a2_3fbe_4928_b2cfb790a01be76a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 510 1 0 "5f2815eb_5940_4c80_b8d2ac89093d25e6" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 511 1 0 "521cbd09_ffdc_4adc_aba37e2d9cf97691" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
ppSensorArray.SetSize(0);
// }} ""
// {{ 512 1 0 "a4f100f0_abdf_418e_bb5ac0ae34e5f386" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 513 1 0 "fa0bf119_7374_4695_9fabf266381e7391" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPPSensor, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 514 1 0 "baf1246e_f64d_450d_a7a948cf90b40a88" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 515 1 0 "62fae2da_1bef_436c_8f6a83615352d361" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 516 1 0 "6aaf52e1_3a20_4588_a952c405bf63270d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 517 1 0 "9f63b926_9379_43c0_8e83cacb14f9b409" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
ppSensorArray.AddAsLast(myPPSensor);
// }} ""
// {{ 518 1 0 "13f335d5_6bf3_4b54_b2b94aea5b636930" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 519 1 0 "74f60b1c_6285_4fd4_8e6168ea912240ba" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 520 1 0 "a0cb793e_4102_4e06_bb63354742b20c0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPPSensor == 1)
{
// }} ""
// {{ 521 1 0 "b78d1106_c05c_4953_a175d8e4710058b2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_33A1CA614CAD4b579CA3528D9C9227CD ;
err.Clear();
// }} ""
// {{ 522 1 0 "af5a135e_34d9_4f3d_9cd8560dc922f1f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "<null>")
{
// }} ""
// {{ 523 1 0 "77dd8675_4e38_4f76_a0cb1d1e72a11772" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 524 1 0 "af5a135e_34d9_4f3d_9cd8560dc922f1f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 525 1 0 "2a9c8a9e_0ca7_4a48_a0b1cb4b8cad5f3d" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 526 1 0 "af5a135e_34d9_4f3d_9cd8560dc922f1f3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 527 1 0 "b78d1106_c05c_4953_a175d8e4710058b2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_33A1CA614CAD4b579CA3528D9C9227CD : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 528 1 0 "1c309abf_1c19_4cf1_892d263a99450885" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 529 1 0 "b78d1106_c05c_4953_a175d8e4710058b2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 530 1 0 "7043d517_302c_4e4f_a0f18fa87357c8a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 531 1 0 "8e19a30e_db3a_4a34_90b8bc3fc27bca44" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 532 1 0 "458af4bc_e613_454d_9c0ba48403088015" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 533 1 0 "53c4d386_e027_4391_8e54fc4591eb8ecc" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 534 1 0 "15009adc_2fcb_4742_af098de2593345c4" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_E96E2C8E30214e45B8ABE954EACB5C3A ;
err.Clear();
// }} ""
// {{ 535 1 0 "3627461a_55d8_4c8d_ac48f8aee8141c68" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 536 1 0 "9fed6328_3408_430f_9b30dcad3de2557c" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 537 1 0 "15009adc_2fcb_4742_af098de2593345c4" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_E96E2C8E30214e45B8ABE954EACB5C3A : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 538 1 0 "a8e5da80_6ea4_48a0_84d9e755146fc3b8" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 539 1 0 "6478ea25_7411_4475_b2f028c323906612" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 540 1 0 "1bb8ebf1_024e_431b_99d98e71548bc449" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("', [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 541 1 0 "de33f36f_f5e6_42b7_ba6ecb6710bcb0d8" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 542 1 0 "acdc0e52_789a_42ab_9d6445393cbffc1f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 543 1 0 "15009adc_2fcb_4742_af098de2593345c4" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 544 1 0 "7043d517_302c_4e4f_a0f18fa87357c8a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 545 1 0 "1d1efefc_07f7_4707_a897320082aa106b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 546 1 0 "aea8bf4a_21fa_435e_8219092b58160fb2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 547 1 0 "5e81f243_1dbf_43ae_b11ab5e5bc94af5e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 548 1 0 "a83ccad3_a4cb_45e2_96fd8aab277a889f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 549 1 0 "7043d517_302c_4e4f_a0f18fa87357c8a9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 550 1 0 "a0cb793e_4102_4e06_bb63354742b20c0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 551 1 0 "2c3532c9_a16e_4d40_bc6f1daaa423e249" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 552 1 0 "ce9e860a_4f5c_4b42_b31cb9eab2b2b8b6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 553 1 0 "28ae9489_9625_409a_b9ce947bdd500b93" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 554 1 0 "76bad614_cd21_4491_84092af522de07f0" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 555 1 0 "a0cb793e_4102_4e06_bb63354742b20c0e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 556 1 0 "baf1246e_f64d_450d_a7a948cf90b40a88" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 557 1 0 "2b49ae57_b86e_4f96_b5ba56204b203430" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 558 1 0 "34c33133_1572_47a0_ae75da492b6891be" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 559 1 0 "5f941bf2_44a1_4c5e_a470c22869ca046e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE BARCODE IS NOT NULL"), Translate(""));
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 560 1 0 "4cb5d981_27ef_44fb_87cb6cfa443e85c7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NOT NULL AND [LiconicPartition] = '"), liconicPartition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 561 1 0 "9be683e5_a62b_48a8_b8db55f033988ead" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 562 1 0 "978d2f45_887c_48d1_9e97dc043708229a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 563 1 0 "57042f7d_8398_4645_80c1d9d9956da2e7" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_INVENTORY_FILE.Eof() == 0)
)
{
// }} ""
// {{ 564 1 0 "f95eb224_47a3_4ccf_9e0d86b7c3764526" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 565 1 0 "a23406c3_4709_42fa_9e40441f7bb8a58c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retValue = Util::Lookup(barcodeInventoryArray, myBarcode, myZeroBasedIndex);
// }} ""
// {{ 566 1 0 "b111872a_ed4c_49b9_a414fe6f6179561c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retValue == 0)
{
// }} ""
// {{ 567 1 0 "7ae8a328_5379_424a_9cfeafe11d092af3" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 568 1 0 "d9ffbade_340f_417e_8ffcefb9b29390b1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 569 1 0 "adb9cb45_222d_493f_a9182e4f64084e30" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 570 1 0 "d9ffbade_340f_417e_8ffcefb9b29390b1" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 571 1 0 "b111872a_ed4c_49b9_a414fe6f6179561c" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 572 1 0 "57042f7d_8398_4645_80c1d9d9956da2e7" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 573 1 0 "2a722566_3e95_4139_97c0ac66f51015df" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 574 1 0 "9eeb7392_807d_4707_af45d2ede2cfb583" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 575 1 0 "077e343c_ed48_4bc8_aa0c0ce2dab1f683" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(arrayIndex = 0; arrayIndex < myArraySize;)
{
arrayIndex = arrayIndex + 1;
// }} ""
// {{ 576 1 0 "a975c07d_7b18_43c5_975e1fc25e2bc4e9" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 577 1 0 "b542214f_7c20_4f48_948ea0f558b8d18f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL, [PlatePresent] = 0 WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 578 1 0 "7bc75b78_3810_4ff1_9777b4e44298eaca" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 579 1 0 "7b55d481_7d50_4e38_82d0bd6dbe09044e" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 580 1 0 "077e343c_ed48_4bc8_aa0c0ce2dab1f683" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 581 1 0 "d54ad365_08ca_4197_86b089c7744409d5" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 582 1 0 "fec5e13c_adf6_47f5_bf86049113d19364" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 583 1 0 "cc0f1c99_9bbb_462e_a0fde8d520a2c89b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPlatesTotal != newEntry)
{
// }} ""
// {{ 584 1 0 "211324d5_bac8_463a_8b2a6a83cb7775f0" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleDE1FC7D74FEE47738629342C32F84870.SetOutput(Translate("There was a Plate Scan Discrepancy!"), Translate("\n   There where:\n\n     "), newEntry, Translate("   Barcodes Read \n\n     AND\n\n     "), myPlatesTotal, Translate("   Plates Flagged"));
dialogHandleDE1FC7D74FEE47738629342C32F84870.ShowOutput(mySTXTitle, hslOKOnly | hslInformation | hslDefButton1, 5);
// }} ""
// {{ 585 1 0 "cc0f1c99_9bbb_462e_a0fde8d520a2c89b" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 586 1 0 "d5a5e9d8_7919_42ba_a62babdf5b40afe9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Update of inventory database complete"));
// }} ""
// {{{ 587 1 0 "eedce6cb_613a_450c_aea3853004114bfd" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (newEntry);
// }} ""
// {{{ 5 "InventoryCarousel_Partial" "End"
}
// }} ""
// {{{ 5 "GetPlateNoBarcode" "Begin"
function GetPlateNoBarcode( variable iCassette, variable iShelf, variable iRemoveFromExperiment, variable & oBarcode ) void {
// }} ""
private variable mySTXTitle;
private variable dlgReturn;
private variable myBarcode;
private variable mySimState;
private variable myFiileName;
private variable mySQLCommand;
private variable myIncubatorID;
private variable myTableName;
private file LOOKUP_PLATE_POSITION_FILE;
private variable myPPStatus;
private dialog dialogHandleF31B7DCC71A34f478EB33910F6B4F117;
private dialog dialogHandleAFC26CC2F1BC4ad3AE695BC7DA0E4480;
// {{ 5 "GetPlateNoBarcode" "InitLocals"
oBarcode = 0;
// }} ""
// {{ 198 1 0 "57e6d078_6812_492e_90823c4e9a8effdd" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************GetPlateNoBarcode Sub**************************************"));
// }} ""
// {{{ 199 1 0 "f1032eb6_3166_4ea7_b5f2b92b757abc4e" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{ 200 1 0 "69de3b41_0ef0_4ecd_bc8ed55a3289d6e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 201 1 0 "d06fffc2_5041_4c90_9045ce1adc14d692" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myTableName, Translate("] WHERE [Cassette] = '"), iCassette, Translate("' AND [Shelf] = '"), iShelf, Translate("'"), Translate(""));
// }} ""
// {{{ 202 1 0 "3beb3731_0cac_41ba_bf84a1f9505bb837" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("SQL Command is: "), mySQLCommand);
// }} ""
// {{ 203 1 0 "5b769277_a2db_4141_86c71c95d6cc7171" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LOOKUP_PLATE_POSITION_FILE.AddField("Barcode", myBarcode, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("PlatePresent", myPPStatus, hslInteger);
if( 0 == LOOKUP_PLATE_POSITION_FILE.Open(myFiileName + " " + myTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 204 1 0 "9ba87596_7326_4fc4_95d0225c161fd606" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LOOKUP_PLATE_POSITION_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 205 1 0 "8208c505_27f8_4e27_8249cdaf092e336b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 206 1 0 "f3ba9834_8d6d_4c10_ab5d644e43d077e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPPStatus == 1)
{
// }} ""
// {{ 207 1 0 "301979e9_c448_4bbc_b634da78de7c4539" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 208 1 0 "3e8c5fb1_93a4_4239_aa772c30d2e2837a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_FB1B1FDD914141259C1A25513E4FF42A ;
err.Clear();
// }} ""
// {{ 209 1 0 "ae855d25_50c4_452d_a1169033fae4d9cc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{{ 210 1 0 "30abe282_8330_4780_932b46084a45e1ac" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
GetBarcodedPlate(myBarcode, iRemoveFromExperiment);
// }} ""
// {{ 211 1 0 "35b39a14_4932_4299_b689907722441133" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oBarcode = myBarcode;
// }} ""
// {{ 212 1 0 "ae855d25_50c4_452d_a1169033fae4d9cc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 213 1 0 "3e8c5fb1_93a4_4239_aa772c30d2e2837a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_FB1B1FDD914141259C1A25513E4FF42A : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 214 1 0 "ea08bc2c_fd1d_46c8_a8a2c59ea6577fd8" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
GetNonBarcodedPlate(iCassette, iShelf);
// }} ""
// {{ 215 1 0 "50f420e2_b295_46c6_a155c40d799c00ce" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oBarcode = Translate("");
// }} ""
// {{ 216 1 0 "3e8c5fb1_93a4_4239_aa772c30d2e2837a" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 217 1 0 "f3ba9834_8d6d_4c10_ab5d644e43d077e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 218 1 0 "fc2baf3e_6cff_42d1_b4d82c00bf2a608e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 219 1 0 "85ad6d6f_edc2_412d_926a366c05a902f9" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleAFC26CC2F1BC4ad3AE695BC7DA0E4480.SetOutput(Translate("There is no plate in Cassette '"), iCassette, Translate("', Shelf '"), iShelf, Translate("'!\nPlease place a plate on the transfer location and press 'OK'.\n\n'Cancel' will abort the run!"));
dlgReturn = dialogHandleAFC26CC2F1BC4ad3AE695BC7DA0E4480.ShowOutput(Translate("Plate not found in Incubator Inventory"), hslOKCancel | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 220 1 0 "0343af50_906f_4a82_91f15db0ff55e313" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (dlgReturn == 2)
{
// }} ""
// {{ 221 1 0 "d47fb704_7f02_4a30_9204e1fdef3b9135" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 222 1 0 "06c23286_60e7_4577_828b027d53662ed7" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 223 1 0 "0343af50_906f_4a82_91f15db0ff55e313" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 224 1 0 "64803c3b_03d2_414b_8e7a9cb3117b05d2" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandleF31B7DCC71A34f478EB33910F6B4F117.SetInputSize(1);
dialogHandleF31B7DCC71A34f478EB33910F6B4F117.SetInputField(0, Translate("Please enter the plate barcode if there is one"), hslString, "");
dialogHandleF31B7DCC71A34f478EB33910F6B4F117.ShowInput(Translate("New Plate Barcode Entry"), hslInfinite, hslOKOnly | hslDefButton1);
oBarcode = dialogHandleF31B7DCC71A34f478EB33910F6B4F117.GetInputField(0);
// }} ""
// {{ 225 1 0 "f3ba9834_8d6d_4c10_ab5d644e43d077e0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 226 1 0 "69de3b41_0ef0_4ecd_bc8ed55a3289d6e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 227 1 0 "099b4659_ec3e_4833_976918d169470924" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oBarcode = Translate("SimulationBarcode");
// }} ""
// {{ 228 1 0 "69de3b41_0ef0_4ecd_bc8ed55a3289d6e5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "GetPlateNoBarcode" "End"
}
// }} ""
// {{{ 5 "GetNewPlateFromPartition" "Begin"
function GetNewPlateFromPartition( variable iPartition, variable iRemovePlateFromExperiment ) variable {
// }} ""
private variable mySTXTitle;
private variable myDBFileName;
private variable myUnitID;
private variable mySimState;
private variable myDBTableName;
private variable mySQLCommand;
private variable myCassette;
private variable myShelf;
private file DB_LOOKUP_FILE;
private variable retryChoice;
private variable fileReadCounter;
private variable myBarcode;
private dialog dialogHandle7494A3A02A3849c19CB546837664E317;
private dialog dialogHandle76DAB545FA8C4c0580202F231638DD1F;
private dialog dialogHandle1;
private dialog dialogHandle920C166EC9EB4c9f91E7938D6AAE271A;
// {{ 5 "GetNewPlateFromPartition" "InitLocals"
// }} ""
// {{ 134 1 0 "01373ad8_d80a_4814_b3e2c66939af483e" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************GetNewPlateFromPartition Sub**************************************"));
// }} ""
// {{{ 135 1 0 "4300da8d_de9e_4034_ab261932b6ee09ec" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 136 1 0 "9b16fd73_e4cd_4181_a75497cc5051fa4d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 137 1 0 "029b8424_163f_4054_8f1eb31c4c8345d8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Partition] = '"), iPartition, Translate("' AND [PlatePresent] = 1 AND [Status] = 'INCUBATOR' ORDER BY[CassetteSortIndex] ASC, [ShelfSortIndex] ASC"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{{ 138 1 0 "929ada3c_2c5c_4f1d_803703e7472adda7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("SQL STATEMENT:  "), mySQLCommand);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 139 1 0 "9bf242ac_835d_436f_84b383b6c9514344" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Partition] = '"), iPartition, Translate("' AND [Barcode] IS NOT NULL AND [Status] = 'INCUBATOR' ORDER BY[CassetteSortIndex] ASC, [ShelfSortIndex] ASC"), Translate(""), Translate(""), Translate(""));
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 140 1 0 "768858b8_88cc_4897_931d614f0ad53ca6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
DB_LOOKUP_FILE.AddField("Cassette", myCassette, hslString, 255);
DB_LOOKUP_FILE.AddField("Shelf", myShelf, hslString, 255);
DB_LOOKUP_FILE.AddField("Barcode", myBarcode, hslString, 255);
if( 0 == DB_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 141 1 0 "b00b1a18_d135_46d9_b64c4ac588383e16" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
fileReadCounter = 0;
while (1 == 1)
{
fileReadCounter = fileReadCounter + 1;
// }} ""
// {{ 142 1 0 "2d69ad71_95bf_4866_9fcf50a9fdd4e7b9" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_0DBC5833FF534d14AFD6A2A66C7B4077 ;
err.Clear();
// }} ""
// {{ 143 1 0 "757e5386_95e3_41cf_a4d21b005412f05a" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 144 1 0 "4df350de_0ce8_4022_ab54824e7e8abe87" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 145 1 0 "2d69ad71_95bf_4866_9fcf50a9fdd4e7b9" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_0DBC5833FF534d14AFD6A2A66C7B4077 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 146 1 0 "ea218a42_f6dd_4f3a_8a767308bcd963df" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 147 1 0 "4df7f64f_44e0_49ec_ba76dc9f050584a1" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 148 1 0 "6a16196d_0f81_45b4_b0482b9d98bfe413" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (fileReadCounter == 1)
{
// }} ""
// {{ 149 1 0 "bacaaea3_574f_433c_86cd653e121dac79" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle1.SetOutput(Translate("Need to inventory!"));
dialogHandle1.ShowOutput("", hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 150 1 0 "f0d8ab03_c0f0_4b8a_81ee1602b3834a0d" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InventoryCarousel_Partial(iPartition);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 151 1 0 "6a16196d_0f81_45b4_b0482b9d98bfe413" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 152 1 0 "1716612b_595d_4b44_8b957bb73e6b8317" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (fileReadCounter == 2)
{
// }} ""
// {{ 153 1 0 "db155d8f_9979_4540_baaa151db9ab0dd2" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle76DAB545FA8C4c0580202F231638DD1F.SetOutput(Translate("The Liconic STX Unit has no plates in specific partition \""), iPartition, Translate("\".\n\nPlease add plates to the partition and try again!"), Translate("\n\n\"Cancel\" will abort the method!"));
retryChoice = dialogHandle76DAB545FA8C4c0580202F231638DD1F.ShowOutput("", hslRetryCancel | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 154 1 0 "114e72c2_f98b_46a7_aac403cb206993b9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retryChoice != 2)
{
// }} ""
// {{ 155 1 0 "ae34cc90_2670_4d2b_b59f3e0a500e3b46" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle920C166EC9EB4c9f91E7938D6AAE271A.SetOutput(Translate("Need to inventory!"));
dialogHandle920C166EC9EB4c9f91E7938D6AAE271A.ShowOutput("", hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 156 1 0 "9a3004f4_74f1_498f_a7dd0c48b73821a0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InventoryCarousel_Partial(iPartition);
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 157 1 0 "114e72c2_f98b_46a7_aac403cb206993b9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 158 1 0 "02da6185_6d23_4b75_b23afd6e7d7b9913" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 159 1 0 "114e72c2_f98b_46a7_aac403cb206993b9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 160 1 0 "1716612b_595d_4b44_8b957bb73e6b8317" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 161 1 0 "5f1ded93_bffb_43cf_b7419fd2891c89c3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (fileReadCounter == 3)
{
// }} ""
// {{ 162 1 0 "d1fc6fb8_d262_4a82_9321baf6693285e0" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle7494A3A02A3849c19CB546837664E317.SetOutput(Translate("The Liconic STX Unit has no plates in specific partition \""), iPartition, Translate("\".\n\nThe method will be aborted!"));
dialogHandle7494A3A02A3849c19CB546837664E317.ShowOutput("", hslOKOnly | hslInformation | hslDefButton1, 600);
// }} ""
// {{ 163 1 0 "8dfe6eec_d7bc_497d_a722b05fba41c1e4" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 164 1 0 "5f1ded93_bffb_43cf_b7419fd2891c89c3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 165 1 0 "2d69ad71_95bf_4866_9fcf50a9fdd4e7b9" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 166 1 0 "b00b1a18_d135_46d9_b64c4ac588383e16" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 167 1 0 "f8d754c9_a9ca_484d_96a3e61317723af3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 168 1 0 "253c4429_47a2_4cd1_ad90d67836e1dacb" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_0C8992F9EDDA4e739ACD42171E824EDF ;
err.Clear();
// }} ""
// {{ 169 1 0 "6fa03000_e5ed_4715_9d0cc6651970f8d3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{{ 170 1 0 "b716f5bf_5dd7_49e2_89222f25e2226ebe" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
GetBarcodedPlate(myBarcode, iRemovePlateFromExperiment);
// }} ""
// {{ 171 1 0 "6fa03000_e5ed_4715_9d0cc6651970f8d3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 172 1 0 "253c4429_47a2_4cd1_ad90d67836e1dacb" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_0C8992F9EDDA4e739ACD42171E824EDF : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 173 1 0 "2f5ffabc_4f20_4d53_93e728139f815bcf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
GetNonBarcodedPlate(myCassette, myShelf);
// }} ""
// {{ 174 1 0 "253c4429_47a2_4cd1_ad90d67836e1dacb" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 175 1 0 "82fa3201_7756_4d3d_9ec4e3b791d9b196" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 176 1 0 "9b16fd73_e4cd_4181_a75497cc5051fa4d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 177 1 0 "87205d3d_f0e8_42a2_b4a6d48ce7da8548" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
myBarcode = Translate("SimulationBarcode");
// }} ""
// {{ 178 1 0 "9b16fd73_e4cd_4181_a75497cc5051fa4d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 179 1 0 "a2e053d4_9974_4cfb_91e8f7fdefc3f313" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (myBarcode);
// }} ""
// {{{ 5 "GetNewPlateFromPartition" "End"
}
// }} ""
// {{{ 5 "StoreNewPlateInPartition" "Begin"
function StoreNewPlateInPartition( variable iBarcode, variable iPartition ) void {
// }} ""
private variable mySTXTitle;
private variable myDBFileName;
private variable myUnitID;
private variable mySimState;
private variable myDBTableName;
private variable mySQLCommand;
private variable retVal;
private variable myCassette;
private variable tmpBarcode;
private variable dlgReturn;
private variable loopCounter1;
private variable myShelf;
private variable stepReturn;
private variable level;
private variable fileReadCounter;
private variable slot;
private variable retval;
private file DB_UPDATE_FILE;
private file DB_LOOKUP_FILE;
private dialog dialogHandle8A4C1E2C0ECD4b2b9AA7598DA8D258AD;
private dialog dialogHandleEFDFE3AABC70477b8BB20685DB5433CC;
private dialog dialogHandleEFFF490CE586488094580A02C55B282F;
private dialog dialogHandleCA0203E4CC324e7aAD9820E124C0DA99;
private dialog dialogHandle6C1C677099704843A2CE9BB5B97EA345;
private dialog dialogHandleE3B89774423E43b59812EC4B8E0F6CB2;
private dialog dialogHandleA64AC27DA5464302BDE6888D7EA531FA;
// {{ 5 "StoreNewPlateInPartition" "InitLocals"
// }} ""
// {{ 1065 1 0 "a56a8223_2b5c_4082_8df45db8a6601c39" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************StoreNewPlateInPartition Sub**************************************"));
// }} ""
// {{{ 1066 1 0 "9a8c2f2e_c95c_4a0c_a25ce5ff834c3ea9" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 1067 1 0 "3301c171_fb79_43bd_ae96acdb99e3a405" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 1068 1 0 "2c55a30c_bd67_494f_916878d68c1f5a72" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1069 1 0 "6e33a541_9b29_4f44_943bf5878964df2b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NULL AND [PlatePresent] = 0 AND [Partition] = '"), iPartition, Translate("' ORDER BY [CassetteSortIndex] ASC, [ShelfSortIndex] ASC"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1070 1 0 "38f27b21_4ec8_4d52_82345fa8c7d6947f" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
DB_LOOKUP_FILE.AddField("Cassette", myCassette, hslString, 255);
DB_LOOKUP_FILE.AddField("Shelf", myShelf, hslString, 255);
if( 0 == DB_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1071 1 0 "7c82f742_8165_4a14_9cc9b6e3ac30abee" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
fileReadCounter = 0;
while (1 == 1)
{
fileReadCounter = fileReadCounter + 1;
// }} ""
// {{ 1072 1 0 "4679e870_bb49_4967_85535ab863d916ad" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_FCFF489234614df59FB3206110CD57D7 ;
err.Clear();
// }} ""
// {{ 1073 1 0 "93217d14_4062_4ca8_9030422ea8edcd9d" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1074 1 0 "22372d27_3810_4b32_b225b37c08f78bda" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1075 1 0 "4679e870_bb49_4967_85535ab863d916ad" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_FCFF489234614df59FB3206110CD57D7 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1076 1 0 "c506350c_7fdd_4d3e_beb0eff1a107a2f7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1077 1 0 "1ae4f195_f958_4a34_8aacc7132b042265" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 1078 1 0 "1d7908c0_c039_4aae_88b38c64a0816963" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (fileReadCounter == 2)
{
// }} ""
// {{ 1079 1 0 "1f8afcf9_8639_4052_be3cb2a922ce3363" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleCA0203E4CC324e7aAD9820E124C0DA99.SetOutput(Translate("The Liconic STX Unit is full in the specifiec partition \""), iPartition, Translate("\".\n\nThe method will abort!"));
dialogHandleCA0203E4CC324e7aAD9820E124C0DA99.ShowOutput("", hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1080 1 0 "8eb0b656_e87d_4494_b697dee038cad406" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1081 1 0 "1d7908c0_c039_4aae_88b38c64a0816963" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1082 1 0 "f7578074_301a_486f_80a295346584f359" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
InventoryCarousel_Partial(iPartition);
// }} ""
// {{ 1083 1 0 "4679e870_bb49_4967_85535ab863d916ad" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 1084 1 0 "7c82f742_8165_4a14_9cc9b6e3ac30abee" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1085 1 0 "8512611e_0b05_47e3_ac6e9c8f32b46aec" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 1086 1 0 "360b8a50_cdee_4fbe_8fe0e80d55537e5a" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1087 1 0 "82b28982_b9b5_44c2_a2088d48ce4cd31b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(myCassette);
// }} ""
// {{{ 1088 1 0 "75f1dfa6_617b_4400_bd2820bb22edb9cf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(myShelf);
// }} ""
// {{{ 1089 1 0 "0592488b_96bd_4e68_ab5d48d42d77d535" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1090 1 0 "0c2f125e_b0ca_48cb_a8366844a1b3d3ba" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start storage of new plate"));
// }} ""
// {{ 1091 1 0 "d4804265_6882_4c6b_97a745a0a1432f82" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounter1 = 0;
while (1 == 1)
{
loopCounter1 = loopCounter1 + 1;
// }} ""
// {{{ 1092 1 0 "05eec769_ef79_45fd_84d532de96178f02" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myUnitID, 1, 0, 0, 2, 0, myUnitID, 2, slot, level, 1, 0);
// }} ""
// {{ 1093 1 0 "f6467383_2441_4576_bc4409026a91cea9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1094 1 0 "f16258a8_8175_4bec_8bcf883f3c48ab73" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle6C1C677099704843A2CE9BB5B97EA345.SetOutput(Translate("The incubator returned an error moving the plate!\nPlease check logfile for details."));
dialogHandle6C1C677099704843A2CE9BB5B97EA345.ShowOutput(Translate("Incubator Error moving plate Store New plate"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1095 1 0 "6038522e_c9eb_414b_93f693dbd672fe8b" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1096 1 0 "f6467383_2441_4576_bc4409026a91cea9" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1097 1 0 "15418426_0e87_4781_aa53d577ae20a038" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{ 1098 1 0 "52ae4c1e_5b21_4dd4_8529ae0409074fb2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (iBarcode == "")
{
// }} ""
// {{{ 1099 1 0 "fdfc1c38_977c_405e_b6baf655988f89cf" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), Translate("NULL"), Translate(", [PlatePresent] = 1, [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1100 1 0 "739f805f_5660_4106_83bd5a418d944583" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 1101 1 0 "112cd215_e8de_4e99_a8632b2c4bbf96fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 1102 1 0 "112cd215_e8de_4e99_a8632b2c4bbf96fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1103 1 0 "9f867b8d_e303_4fa0_b5bf1d36f0b83565" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandleEFFF490CE586488094580A02C55B282F.SetInputSize(1);
dialogHandleEFFF490CE586488094580A02C55B282F.SetInputField(0, Translate("Plate Barcode"), hslString, "");
dialogHandleEFFF490CE586488094580A02C55B282F.ShowInput(Translate("Liconic Simulation Barcode Entry"), hslInfinite, hslOKOnly | hslDefButton1);
iBarcode = dialogHandleEFFF490CE586488094580A02C55B282F.GetInputField(0);
// }} ""
// {{ 1104 1 0 "d258583f_1a60_44e6_a92ca416798664c7" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
retval = HSLLiconicSTX::TRUE;
// }} ""
// {{ 1105 1 0 "112cd215_e8de_4e99_a8632b2c4bbf96fb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1106 1 0 "cbae8c29_e90c_4a8b_b507ad7a678b0a28" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retVal = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, iBarcode);
// }} ""
// {{{ 1107 1 0 "fb3544e9_6d06_47da_bcb4d86414aee446" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{ 1108 1 0 "fd306510_6411_4dbd_8e13158bb812e177" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retVal == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1109 1 0 "0eb6de62_25e4_4c45_b7a5af83ef75ce54" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 1110 1 0 "ae2e9bfd_fe0f_4d8f_9ceb3650aae1955f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retVal = HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, iBarcode);
// }} ""
// {{ 1111 1 0 "222ad251_8240_4cf3_be8d8152af357ab8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retVal == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1112 1 0 "13f7aeba_c011_4d72_a7cf0fd4eba0be42" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleEFDFE3AABC70477b8BB20685DB5433CC.SetOutput(Translate("LICONIC STX220 WARNING!!!"), Translate("\n\n The Barcode on the plate in Slot "), myCassette, Translate(", Level "), myShelf, Translate(" could not be read."), Translate("\nPlease check the barcode of this plate so it can be entered manually."), Translate("\n\nHit 'OK' to proceed to enter the plate barcode"));
dialogHandleEFDFE3AABC70477b8BB20685DB5433CC.ShowOutput(Translate("Liconic STX 220 Barcode Warning"), hslOKOnly | hslQuestion | hslDefButton1, hslInfinite);
// }} ""
// {{ 1113 1 0 "53dd410e_8c19_4176_89656f7477f6c913" "{B31F3539-5D80-11d4-A5EB-0050DA737D89}"
dialogHandle8A4C1E2C0ECD4b2b9AA7598DA8D258AD.SetInputSize(1);
dialogHandle8A4C1E2C0ECD4b2b9AA7598DA8D258AD.SetInputField(0, Translate("Plate Barcode"), hslString, "");
dialogHandle8A4C1E2C0ECD4b2b9AA7598DA8D258AD.ShowInput(Translate("Liconic STX 220 Barcode Entry"), hslInfinite, hslOKOnly | hslDefButton1);
iBarcode = dialogHandle8A4C1E2C0ECD4b2b9AA7598DA8D258AD.GetInputField(0);
// }} ""
// {{ 1114 1 0 "222ad251_8240_4cf3_be8d8152af357ab8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1115 1 0 "fd306510_6411_4dbd_8e13158bb812e177" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1116 1 0 "52ae4c1e_5b21_4dd4_8529ae0409074fb2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{{ 1117 1 0 "78de4018_7dee_4fb1_88fd40ea6053cca5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), iBarcode, Translate("', [PlatePresent] = 1, [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1118 1 0 "542101cc_40af_409d_88a6150ab597bd58" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 1119 1 0 "bc5db29a_6012_481a_bba7b93047679812" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLLiconicSTX::COMMAND::ServiceReadBarcode(myUnitID, slot, level, tmpBarcode);
// }} ""
// {{ 1120 1 0 "b4651427_f17d_4493_909e69fc24005e7e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (tmpBarcode != iBarcode)
{
// }} ""
// {{{ 1121 1 0 "a9a62cc3_f785_40bf_9977234614056e18" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myUnitID, 2, slot, level, 2, 0, myUnitID, 1, 0, 0, 1, 0);
// }} ""
// {{ 1122 1 0 "28c9ffcc_8e1b_4aa8_a4e98bc3f00567d3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1123 1 0 "48ec10ef_315e_42b0_b13548526421cb9e" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleA64AC27DA5464302BDE6888D7EA531FA.SetOutput(Translate("The incubator returned an error reading the barcode!\nPlease check logfile for details."));
dialogHandleA64AC27DA5464302BDE6888D7EA531FA.ShowOutput(Translate("Incubator Error Barcode error in Store New Plate"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1124 1 0 "c9a6200e_3a65_42c5_a983918660733bba" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1125 1 0 "28c9ffcc_8e1b_4aa8_a4e98bc3f00567d3" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1126 1 0 "99c91f77_3b82_4988_a266cadc20f65f37" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleE3B89774423E43b59812EC4B8E0F6CB2.SetOutput(Translate("The plate with barcode '"), tmpBarcode, Translate("' does not match the expected barcode '"), iBarcode, Translate("'!\nPlease replace it on the loading position and press OK afterwards."));
dlgReturn = dialogHandleE3B89774423E43b59812EC4B8E0F6CB2.ShowOutput(Translate("Wrong plate detected"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 1127 1 0 "b4651427_f17d_4493_909e69fc24005e7e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1128 1 0 "a283ada5_00da_438b_a890cec616b8d8c2" "{B31F3533-5D80-11d4-A5EB-0050DA737D89}"
break;
// }} ""
// {{ 1129 1 0 "b4651427_f17d_4493_909e69fc24005e7e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 1130 1 0 "52ae4c1e_5b21_4dd4_8529ae0409074fb2" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1131 1 0 "d4804265_6882_4c6b_97a745a0a1432f82" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 1132 1 0 "4e04321d_959b_46e8_b9ff952aedc4fd3c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1133 1 0 "d647e808_2b53_42e3_966ee0d8129eac1e" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_UPDATE_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1134 1 0 "3a56b2cc_cd11_4669_892b6ccb9339cb25" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_UPDATE_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_UPDATE_FILE.RemoveFields();
// }} ""
// {{{ 1135 1 0 "2b57d19f_623e_4fcb_9113f3880dd45e8a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("Plate "), iBarcode, Translate(" stored in Cassette "), slot, Translate(", Shelf "), level, Translate(" succesfully"));
// }} ""
// {{ 1136 1 0 "3301c171_fb79_43bd_ae96acdb99e3a405" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "StoreNewPlateInPartition" "End"
}
// }} ""
// {{{ 5 "StorePlateAsUsed" "Begin"
function StorePlateAsUsed( variable iBarcode, variable & oCassette, variable & oShelf ) void {
// }} ""
private dialog dialogHandle0454C3BF41D64e5eB1D539C9D4E0FB11;
private variable myPlateStatus;
private variable mySTXTitle;
private variable myBarcode;
private variable level;
private variable stepReturn;
private variable mySimState;
private variable mySQLCommand;
private variable slot;
private variable myFiileName;
private variable myIncubatorID;
private variable myTableName;
private file UPDATE_STATUS_FILE;
private file LOOKUP_PLATE_POSITION_FILE;
private dialog dialogHandle653FD05E0CDC49feBA53C9F5123D35FA;
// {{ 5 "StorePlateAsUsed" "InitLocals"
oCassette = 0;
oShelf = 0;
// }} ""
// {{ 1205 1 0 "e07bb572_8345_4086_bb921eecfbb3a590" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************StorePlate Sub**************************************"));
// }} ""
// {{{ 1206 1 0 "bf0a3fd6_b936_46ab_a6b419e0c8bc8c40" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{ 1207 1 0 "a4a7797c_25e8_4c80_8ae515d760c5b404" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1208 1 0 "6f929099_1fbe_4f6d_815403dfada06dab" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myTableName, Translate("] WHERE [Barcode] = '"), iBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1209 1 0 "55ee1583_a833_4c88_ac19cb4778842d94" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LOOKUP_PLATE_POSITION_FILE.AddField("Cassette", oCassette, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Shelf", oShelf, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Barcode", myBarcode, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Status", myPlateStatus, hslString, 255);
if( 0 == LOOKUP_PLATE_POSITION_FILE.Open(myFiileName + " " + myTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1210 1 0 "4ff5f7f8_f458_4665_8c25f013d0f698c2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_8386AD1B71744cc88A690D58D1AC24C6 ;
err.Clear();
// }} ""
// {{ 1211 1 0 "6c010824_ac6c_4ea8_9bb3cf8fa38cd6b8" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LOOKUP_PLATE_POSITION_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1212 1 0 "4ff5f7f8_f458_4665_8c25f013d0f698c2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_8386AD1B71744cc88A690D58D1AC24C6 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1213 1 0 "033f8d0a_7813_413c_948fcafeb35ddf7a" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 1214 1 0 "20acf251_8658_4156_a1534a00d43bd3a2" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle653FD05E0CDC49feBA53C9F5123D35FA.SetOutput(Translate("The plate with barcode '"), iBarcode, Translate("' could not be found in incubator inventory!\nYou cannot store back an unknown plate."));
dialogHandle653FD05E0CDC49feBA53C9F5123D35FA.ShowOutput(Translate("Barcode not found in Incubator Inventory"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 1215 1 0 "d2de42c0_5679_4023_848835e5d4ba22ce" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1216 1 0 "4ff5f7f8_f458_4665_8c25f013d0f698c2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{{ 1217 1 0 "37ab1d21_7bd5_4bc3_9cc6c2bbc8e74088" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(oCassette);
// }} ""
// {{{ 1218 1 0 "3a65b29f_ec44_461f_a6a89ac2aa23ef0c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(oShelf);
// }} ""
// {{{ 1219 1 0 "bdeb2afc_3488_435b_87712f5f37a30a4f" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1220 1 0 "49db629a_6cb3_4b4d_a3caef1be4d25ece" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("Replacing Plate "), iBarcode, Translate(" in Cassette "), slot, Translate(", Shelf "), level, Translate(" started"));
// }} ""
// {{ 1221 1 0 "ac6e2e07_5438_4129_b8bcfc9f821dfa29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1222 1 0 "e1737d1a_4e71_40b4_9425c96f5b33d46a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myIncubatorID, 1, 0, 0, 2, 0, myIncubatorID, 2, slot, level, 1, 0);
// }} ""
// {{ 1223 1 0 "4b261547_ba9b_44bb_8006bbe920a2b851" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1224 1 0 "04e9584c_70fc_4234_bfd05a303c889b73" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle0454C3BF41D64e5eB1D539C9D4E0FB11.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandle0454C3BF41D64e5eB1D539C9D4E0FB11.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1225 1 0 "b5d1c156_3b57_42b0_b0a7e1ecec3fb782" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1226 1 0 "4b261547_ba9b_44bb_8006bbe920a2b851" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1227 1 0 "ac6e2e07_5438_4129_b8bcfc9f821dfa29" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1228 1 0 "4fb073f6_a92f_4552_837ad505ac75b4c2" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1229 1 0 "6fa5076f_c451_4554_bb836918471e09fc" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Replace Plate "), iBarcode, Translate(" complete"));
// }} ""
// {{{ 1230 1 0 "48b6c2ab_a9de_498b_8d5365e7cc369b58" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [PlatePresent] = 1, [Status] = 'INCUBATOR_USED' WHERE [Cassette] = '"), oCassette, Translate("' AND [Shelf] = '"), oShelf, Translate("'"), Translate(""));
// }} ""
// {{ 1231 1 0 "a23cb2ed_9c97_41f1_b6e2c67ec73b400d" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_STATUS_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1232 1 0 "c6becdc3_bbef_4417_b725721e005c706b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_STATUS_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_STATUS_FILE.RemoveFields();
// }} ""
// {{ 1233 1 0 "a4a7797c_25e8_4c80_8ae515d760c5b404" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1234 1 0 "d8f86729_89a1_45d6_93ef098ba91788bf" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oCassette = 1;
// }} ""
// {{ 1235 1 0 "d79b2c02_1e2e_492e_8d77f84f9c99d882" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oShelf = 1;
// }} ""
// {{ 1236 1 0 "a4a7797c_25e8_4c80_8ae515d760c5b404" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "StorePlateAsUsed" "End"
}
// }} ""
// {{{ 5 "StorePlateAsInProcess" "Begin"
function StorePlateAsInProcess( variable iBarcode, variable & oCassette, variable & oShelf ) void {
// }} ""
private dialog dialogHandle01090EC87A794f45A824D636F085A895;
private variable myPlateStatus;
private variable mySTXTitle;
private variable myBarcode;
private variable stepReturn;
private variable level;
private variable mySimState;
private variable slot;
private variable mySQLCommand;
private variable myFiileName;
private variable myIncubatorID;
private variable myTableName;
private file UPDATE_STATUS_FILE;
private file LOOKUP_PLATE_POSITION_FILE;
private dialog dialogHandle0211C06664BE4cab8AAE252803852D87;
// {{ 5 "StorePlateAsInProcess" "InitLocals"
oCassette = 0;
oShelf = 0;
// }} ""
// {{ 1172 1 0 "70c53187_6b43_44d3_b6dba1a259359047" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************StorePlate Sub**************************************"));
// }} ""
// {{{ 1173 1 0 "bc77008d_bdb3_46cc_863b8ae88b9b58b0" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{ 1174 1 0 "bc0d8864_d5da_4bf0_bb627898aa086262" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1175 1 0 "2f9cc3b3_56bd_47bf_9d49fcee60843887" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myTableName, Translate("] WHERE [Barcode] = '"), iBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 1176 1 0 "7447eb90_17e2_455c_a625cbe5f9e95bf4" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LOOKUP_PLATE_POSITION_FILE.AddField("Cassette", oCassette, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Shelf", oShelf, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Barcode", myBarcode, hslString, 255);
LOOKUP_PLATE_POSITION_FILE.AddField("Status", myPlateStatus, hslString, 255);
if( 0 == LOOKUP_PLATE_POSITION_FILE.Open(myFiileName + " " + myTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1177 1 0 "389add7b_e184_4c61_b64a3d34351ac69c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_96EFD81455834513B71D6CD293320F01 ;
err.Clear();
// }} ""
// {{ 1178 1 0 "12e8a4d5_902e_4dfa_89356789e160a050" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LOOKUP_PLATE_POSITION_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 1179 1 0 "389add7b_e184_4c61_b64a3d34351ac69c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_96EFD81455834513B71D6CD293320F01 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 1180 1 0 "a6091a64_1c00_485e_b4ace945854eaa2f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LOOKUP_PLATE_POSITION_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LOOKUP_PLATE_POSITION_FILE.RemoveFields();
// }} ""
// {{ 1181 1 0 "ff4b4dd2_85e3_4ca5_ae640346e58a0ac9" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle0211C06664BE4cab8AAE252803852D87.SetOutput(Translate("The plate with barcode '"), iBarcode, Translate("' could not be found in incubator inventory!\nYou cannot store back an unknown plate."));
dialogHandle0211C06664BE4cab8AAE252803852D87.ShowOutput(Translate("Barcode not found in Incubator Inventory"), hslOKOnly | hslError | hslDefButton1, hslInfinite);
// }} ""
// {{ 1182 1 0 "f431541b_7bc2_459e_869f5a0bbedd76aa" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1183 1 0 "389add7b_e184_4c61_b64a3d34351ac69c" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{{ 1184 1 0 "b9e2bf0b_a7d1_4617_8b8358ec0cabe96d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(oCassette);
// }} ""
// {{{ 1185 1 0 "a0d92d72_8a44_4735_9f5cb736d4bbc6d8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(oShelf);
// }} ""
// {{{ 1186 1 0 "609813c6_358d_4363_9bf3f7d5762fc100" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1187 1 0 "97f2dcfe_5be3_4376_b630becd23820e94" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("Replacing Plate "), iBarcode, Translate(" in Cassette "), slot, Translate(", Shelf "), level, Translate(" started"));
// }} ""
// {{ 1188 1 0 "aa086c70_aee4_410c_b30db4504dfb4065" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1189 1 0 "4faf481d_ac73_4410_9b31b36ef498ace9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myIncubatorID, 1, 0, 0, 2, 0, myIncubatorID, 2, slot, level, 1, 0);
// }} ""
// {{ 1190 1 0 "d06c92fd_da18_40e9_8fa2821552a1f333" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 1191 1 0 "cae3fc7a_0aa4_4df0_ad51052fd451e1e9" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle01090EC87A794f45A824D636F085A895.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandle01090EC87A794f45A824D636F085A895.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 1192 1 0 "ca3c50e2_a98a_4c4f_a024797d45b3d08b" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 1193 1 0 "d06c92fd_da18_40e9_8fa2821552a1f333" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 1194 1 0 "aa086c70_aee4_410c_b30db4504dfb4065" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 1195 1 0 "c99df380_cf76_4c8b_880803e6c2d24b5a" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 1196 1 0 "f072779a_dd2c_45c2_9fabad76fff2e4a4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Replace Plate "), iBarcode, Translate(" complete"));
// }} ""
// {{{ 1197 1 0 "d2a96eb1_1767_4f51_b4ec431e0f6e05de" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [PlatePresent] = 1, [Status] = 'INCUBATOR_IN_PROCESS' WHERE [Cassette] = '"), oCassette, Translate("' AND [Shelf] = '"), oShelf, Translate("'"), Translate(""));
// }} ""
// {{ 1198 1 0 "8306b50e_9398_4fd7_8ad3f9b9c4b76097" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_STATUS_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1199 1 0 "4195a4c1_cb78_4b96_82e5ec0be0059284" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_STATUS_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_STATUS_FILE.RemoveFields();
// }} ""
// {{ 1200 1 0 "bc0d8864_d5da_4bf0_bb627898aa086262" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 1201 1 0 "12a842c0_2eb4_4291_8f31289d1c4ca052" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oCassette = Translate("1");
// }} ""
// {{ 1202 1 0 "433fc086_14fb_475e_bd24c87ac646d277" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
oShelf = Translate("1");
// }} ""
// {{ 1203 1 0 "bc0d8864_d5da_4bf0_bb627898aa086262" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "StorePlateAsInProcess" "End"
}
// }} ""
// {{{ 5 "GetNonBarcodedPlate" "Begin"
private function GetNonBarcodedPlate( variable iCassette, variable iShelf ) void {
// }} ""
private dialog dialogHandle1E1388CFD08D48939149DC8DCF81CF8D;
private variable mySTXTitle;
private variable stepReturn;
private variable level;
private variable mySimState;
private variable mySQLCommand;
private variable slot;
private variable myFiileName;
private variable myIncubatorID;
private variable myTableName;
private file REMOVE_BARCODE_FILE;
// {{ 5 "GetNonBarcodedPlate" "InitLocals"
// }} ""
// {{{ 181 1 0 "08521bcd_e749_462e_99c51fcd69c887ef" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myFiileName, myTableName, myIncubatorID, mySTXTitle, mySimState);
// }} ""
// {{{ 182 1 0 "31939141_1437_4be2_9892c3a3f7102e33" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
slot = StrIVal(iCassette);
// }} ""
// {{{ 183 1 0 "3a90c33b_fd35_4730_b6865630afb7d7ec" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
level = StrIVal(iShelf);
// }} ""
// {{{ 184 1 0 "9294ce73_cb47_452f_acb3a0671387d5a4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("::Get non-barcoded plate from cassette "), iCassette, Translate("; shelf "), iShelf, Translate("Started"), Translate(""), Translate(""));
// }} ""
// {{{ 185 1 0 "d8923e15_7ade_4878_b0b45119663c6f23" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 186 1 0 "b5ef67e3_2e9c_4923_85d9ec499de3dce8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::ServiceMovePlate(myIncubatorID, 2, slot, level, 1, 0, myIncubatorID, 1, 0, 0, 2, 0);
// }} ""
// {{ 187 1 0 "22508be7_6a61_4278_be1f9870d3e0bc6d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 188 1 0 "c906a6ab_83f5_4843_9889d5539c77b057" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle1E1388CFD08D48939149DC8DCF81CF8D.SetOutput(Translate("The incubator returned an error!\nPlease check logfile for details."));
dialogHandle1E1388CFD08D48939149DC8DCF81CF8D.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 189 1 0 "d6485bcd_bccb_4fe6_90882070bbc7badf" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 190 1 0 "22508be7_6a61_4278_be1f9870d3e0bc6d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 191 1 0 "eb36ecf1_2636_465d_9ac6b2006eb793db" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 192 1 0 "f127d456_f13c_4a1c_84aa87a97b026dac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace8(mySTXTitle, Translate("::Get non-barcoded plate from cassette "), iCassette, Translate("; shelf "), iShelf, Translate("Finished"), Translate(""), Translate(""));
// }} ""
// {{{ 193 1 0 "6a3532bb_7ed4_43c8_b71c3fc1dc63f521" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = 0,  [Status] = NULL WHERE [Cassette] = '"), iCassette, Translate("' AND [Shelf] = '"), iShelf, Translate("'"), Translate(""));
// }} ""
// {{{ 194 1 0 "8b033e13_14b3_4c7d_8af5f6a17d8b02a2" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("SQL COMMAND:  "), mySQLCommand);
// }} ""
// {{ 195 1 0 "6c7c9765_9114_4e65_a7157542006fd42b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == REMOVE_BARCODE_FILE.Open(myFiileName + " " + myTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myFiileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 196 1 0 "24acc0f2_070b_401c_9086575771bb7adf" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != REMOVE_BARCODE_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
REMOVE_BARCODE_FILE.RemoveFields();
// }} ""
// {{{ 5 "GetNonBarcodedPlate" "End"
}
// }} ""
// {{{ 5 "InventoryCarousel_PartialVariableDelay" "Begin"
function InventoryCarousel_PartialVariableDelay( variable Partition, variable PartitionTime ) variable {
// }} ""
private dialog dialogHandle455C792D7B87427c971B03C44F75A15E;
private dialog dialogHandle6D5F66934F964d29BEB15F00C1F40741;
private dialog dialogHandle8CD1EA859E654ac9BDD256910EC3BF5A;
private dialog dialogHandle9CAF5B7AEF6C4d798B9737D4E0455433;
private variable liconicPartition;
private variable shelf;
private variable newEntry;
private variable myCassette;
private variable cassette;
private variable myPlatesTotal;
private variable mySTXTitle;
private variable myPlate;
private variable myBarcode;
private variable partitionCounter;
private variable myDBFileName;
private variable numOfPartitions;
private variable myInventoryFileName;
private variable arrayIndex;
private variable myShelf;
private variable loopCounterFileCheck;
private variable nullBarcode;
private variable myUnitID;
private variable myZeroBasedIndex;
private variable myArraySize;
private variable stepReturn;
private variable myInventoryFileNameCheck;
private variable myPPSensor;
private variable mySimState;
private variable myDBTableName;
private variable retValue;
private variable myArrayIndex;
private variable myStatus;
private variable mySQLCommand;
private timer PartialInventoryTimer_Unit1;
private file READ_DB_INVENTORY_FILE;
private file LICONIC_INV_FILE;
private file PARTITION_NAME_LOOKUP_FILE;
private file UPDATE_DB_INVENTORY_FILE;
private variable arrLiconicPartitions[];
private variable shelfInventoryArray[];
private variable nullCassetteArray[];
private variable barcodeToRemoveArray[];
private variable nullShelfArray[];
private variable cassetteInventoryArray[];
private variable plateInventoryArray[];
private variable barcodeInventoryArray[];
private variable ppSensorArray[];
// {{ 5 "InventoryCarousel_PartialVariableDelay" "InitLocals"
// }} ""
// {{ 792 1 0 "a96dc015_ab3f_4d66_9fa9266e143e01a7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************InventoryIncubator_Partial Sub**************************************"));
// }} ""
// {{{ 793 1 0 "0c38a79f_372d_464f_bfa13fdbae103d67" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 794 1 0 "9ca1fd41_04ab_4bf5_a85dbae7d97d3056" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PartitionTime = 120;
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 795 1 0 "7c9dac16_2c6b_4763_801bb08c8e73acf9" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
myInventoryFileName = Translate("C:\\Liconic Inventory Files\\STXCarousel_PARTIAL_INV.txt");
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 796 1 0 "b52aacb3_41e9_40b3_b656badd26513395" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 797 1 0 "d49132c7_5170_4bac_97a49f2250454cfd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myInventoryFileName == myInventoryFileNameCheck)
{
// }} ""
// {{{ 798 1 0 "1c2baf85_7135_423d_bb8b77576c4bc6a6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 799 1 0 "d49132c7_5170_4bac_97a49f2250454cfd" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 800 1 0 "984c4d7f_6e82_41a7_937f2d27ab32f78c" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 801 1 0 "17151a0f_757e_48a3_b4d4ad579eef96e9" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" started"));
// }} ""
// {{ 802 1 0 "c0fffef4_74b3_4716_924c9881602ca9cf" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 803 1 0 "d43fd120_0ab5_4fdf_91e0393502b7b39e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT DISTINCT [LiconicPartition] FROM ["), myDBTableName, Translate("] WHERE [Partition] = '"), Partition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 804 1 0 "6737b4d2_fab2_4bc7_b2861125c52d3d70" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
PARTITION_NAME_LOOKUP_FILE.AddField("LiconicPartition", liconicPartition, hslString, 255);
if( 0 == PARTITION_NAME_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 805 1 0 "5b409018_21ad_4518_9b867ed058e9ffdb" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
arrLiconicPartitions.SetSize(0);
// }} ""
// {{ 806 1 0 "4ac97bd5_2bb4_4702_81ef6cc2bd0ee30f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (PARTITION_NAME_LOOKUP_FILE.Eof() == 0)
)
{
// }} ""
// {{ 807 1 0 "f79675cc_2070_4de7_9cfbd0d3957f15c6" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PARTITION_NAME_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 808 1 0 "7818db78_25a7_468e_9bc3c0dbac4dcbc4" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
arrLiconicPartitions.AddAsLast(liconicPartition);
// }} ""
// {{ 809 1 0 "4ac97bd5_2bb4_4702_81ef6cc2bd0ee30f" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 810 1 0 "f5853353_41fc_4af4_8b6c9a8defdf2d09" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != PARTITION_NAME_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
PARTITION_NAME_LOOKUP_FILE.RemoveFields();
// }} ""
// {{ 811 1 0 "130ed385_61d2_4270_857557f8bb823f86" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 812 1 0 "5e549bbb_e0b3_4404_9f8b62f70541d9c1" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
numOfPartitions=arrLiconicPartitions.GetSize();
// }} ""
// {{ 813 1 0 "959674d8_fbf7_46fe_b2586d80403821d3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(partitionCounter = 0; partitionCounter < numOfPartitions;)
{
partitionCounter = partitionCounter + 1;
// }} ""
// {{{ 814 1 0 "31235bee_9e04_4d87_af5ba7e9db49406b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 815 1 0 "89f1b3e2_aab2_41c9_a093eade3b83f21d" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
liconicPartition=arrLiconicPartitions.GetAt(partitionCounter-1);
// }} ""
// {{{ 816 1 0 "09869bcb_8618_49c7_ad00fa67a3f3e7ba" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::PartialInventoryScan(myUnitID, myInventoryFileName, liconicPartition, 1, 1);
// }} ""
// {{ 817 1 0 "a1019ad7_b83b_4096_a94c95a1aede99d5" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.SetTimer(PartitionTime) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 818 1 0 "d8589e31_8eae_4eff_a3d07386b53de05e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 819 1 0 "9ff39195_e210_4da0_9fa548dc8a24cf27" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle455C792D7B87427c971B03C44F75A15E.SetOutput(Translate("The incubator returned an error!\n\nPlease check logfile for details."));
dialogHandle455C792D7B87427c971B03C44F75A15E.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 820 1 0 "d105e449_8016_451b_9db026eb1d5e4bef" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 821 1 0 "d8589e31_8eae_4eff_a3d07386b53de05e" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 822 1 0 "c06c55ae_7902_4af4_bcd68a63005c0385" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.WaitTimer(hslTrue, hslTrue) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 823 1 0 "45045337_3762_436c_b0cf4513be6b2594" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 824 1 0 "3d785dee_8f1c_4235_8b6779d1780a4951" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounterFileCheck = 0;
while (myInventoryFileName != myInventoryFileNameCheck)
{
loopCounterFileCheck = loopCounterFileCheck + 1;
// }} ""
// {{ 825 1 0 "729e0e96_00c2_49e8_b1cde2246c026e93" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 200)
{
// }} ""
// {{ 826 1 0 "8246a327_8d03_4282_ba74aada0baa976e" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle8CD1EA859E654ac9BDD256910EC3BF5A.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not completing.... \n\n\n ABORT and run again......"));
dialogHandle8CD1EA859E654ac9BDD256910EC3BF5A.ShowOutput(Translate("STX220 Invenoty Write File Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 827 1 0 "33bb7ed2_6c92_45db_97f8b7aaee116334" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 828 1 0 "729e0e96_00c2_49e8_b1cde2246c026e93" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 829 1 0 "454369d5_1632_4c15_bd617cdc5673f7c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 20)
{
// }} ""
// {{ 830 1 0 "49bbd3aa_8aa2_4268_9918b4b311825a2a" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle9CAF5B7AEF6C4d798B9737D4E0455433.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not complete.... \n\n\n Delay 20 sec......"));
dialogHandle9CAF5B7AEF6C4d798B9737D4E0455433.ShowOutput(Translate("STX220 Invenoty Delay "), hslOKOnly | hslInformation | hslDefButton1, 20);
// }} ""
// {{ 831 1 0 "454369d5_1632_4c15_bd617cdc5673f7c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 832 1 0 "729e0e96_00c2_49e8_b1cde2246c026e93" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 833 1 0 "5aedf8a6_39a3_462a_a9251be1f6a7d524" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 834 1 0 "3d785dee_8f1c_4235_8b6779d1780a4951" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 835 1 0 "0808addd_3514_46a7_a395b4a23eb636b3" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 836 1 0 "320bedd8_1862_48bb_ae88598da1ee821d" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" complete"));
// }} ""
// {{{ 837 1 0 "0285b9a9_462a_4ba5_8a6a1f9715a212a7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start update of inventory database"));
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 838 1 0 "8bbe3f3b_cd08_4642_8f3c003f5b5b5fb1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 839 1 0 "ef9bb0d0_9765_4ce8_a4080874863c00c2" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 840 1 0 "7dda3507_f6e9_4e78_b329583313ba8897" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 841 1 0 "72e9680e_c339_47f5_b1dc5ca36ec3b7e3" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 842 1 0 "68aab9bd_ed3a_4717_a036dc8565e899ae" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
plateInventoryArray.SetSize(0);
// }} ""
// {{ 843 1 0 "82beefa6_67d6_4de2_931aeb910f61da3d" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPlate, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 844 1 0 "05f8dabe_dacb_4774_a984b675a322f859" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 845 1 0 "a31acc3c_7cfe_48cd_91262929fb0ab0f5" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 846 1 0 "80dcbbfa_f501_4b12_89827e8081d83669" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 847 1 0 "4d931260_988c_4bcb_936f6ef88861ac7d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 848 1 0 "42c0f773_0962_4b62_96afa476c2c775d9" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 849 1 0 "f28f7497_f0b3_4cd0_97c9545f99606e89" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 850 1 0 "1a81f49a_fdaa_48aa_bfaa6d664fa5b058" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullCassetteArray.SetSize(0);
// }} ""
// {{ 851 1 0 "efbf97ce_ac32_4b4b_b2b0440f58ca9efd" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
plateInventoryArray.AddAsLast(myPlate);
// }} ""
// {{ 852 1 0 "218cb99c_eb7b_437a_9238a2792d7f0981" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullShelfArray.SetSize(0);
// }} ""
// {{ 853 1 0 "557fc947_87b7_4a01_ab1babef5cc0596e" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
myPlatesTotal = myPlatesTotal + myPlate;
// }} ""
// {{ 854 1 0 "716a1f81_0b4a_4b96_8d8f3d33f98dc4ce" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_E2456466186A41a3B14EC7F50EF4CBD3 ;
err.Clear();
// }} ""
// {{ 855 1 0 "78863eb9_2cf2_4689_bfae632662c071fc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 856 1 0 "af99ec7f_4923_405b_8724960682b29bf4" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 857 1 0 "78863eb9_2cf2_4689_bfae632662c071fc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 858 1 0 "43c2b425_dad9_4489_b6770917ad809f05" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 859 1 0 "78863eb9_2cf2_4689_bfae632662c071fc" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 860 1 0 "716a1f81_0b4a_4b96_8d8f3d33f98dc4ce" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_E2456466186A41a3B14EC7F50EF4CBD3 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 861 1 0 "2a5e1867_80a2_4cff_bb5f7b0f769e3079" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 862 1 0 "716a1f81_0b4a_4b96_8d8f3d33f98dc4ce" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 863 1 0 "17287394_f7d5_4012_92cdb6d84cc441f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 864 1 0 "7138252d_78f4_4d23_89f38020120d3e94" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 865 1 0 "aded3430_e54e_4077_bcaef6100b10be3a" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 866 1 0 "0aca5b26_95d8_4305_8a3a6acec72a1e30" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 867 1 0 "e83e6ba0_2f62_4d61_a13da6967cab667e" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_2D05FE39D115450c819C4A3C4AA78B5B ;
err.Clear();
// }} ""
// {{ 868 1 0 "c162ea43_3817_4c0e_b8561ff6720eb1ee" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 869 1 0 "862bcc9e_43e0_4e9a_85bdacf88d8ed374" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 870 1 0 "e83e6ba0_2f62_4d61_a13da6967cab667e" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_2D05FE39D115450c819C4A3C4AA78B5B : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 871 1 0 "36067c63_0440_4491_bd945168d5ffee93" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 872 1 0 "cb298e20_1227_486b_aa24707e186de959" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 873 1 0 "743fd767_e04c_47ec_9b1db413b68189f4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("' , [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 874 1 0 "9f18a884_9524_4bf6_b34228cae54dff30" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 875 1 0 "559d7533_31d8_40dc_91d994349dfaaaef" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 876 1 0 "bf23f41a_a8bb_489e_a5d600ae13bc43f9" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
newEntry = newEntry + 1;
// }} ""
// {{ 877 1 0 "e83e6ba0_2f62_4d61_a13da6967cab667e" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 878 1 0 "17287394_f7d5_4012_92cdb6d84cc441f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 879 1 0 "88f39081_e9e4_4bdd_88bcae8f0b75a352" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullCassetteArray.AddAsLast(myCassette);
// }} ""
// {{ 880 1 0 "4b437429_5e97_460e_b3a4b14d1d7d0df7" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullShelfArray.AddAsLast(myShelf);
// }} ""
// {{ 881 1 0 "17287394_f7d5_4012_92cdb6d84cc441f8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 882 1 0 "05f8dabe_dacb_4774_a984b675a322f859" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 883 1 0 "afdafdfa_a5e7_496d_84b2c7b30c2f45b2" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 884 1 0 "877fa9e2_c7a0_4197_ab79be367836fbc6" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 885 1 0 "d82b6603_ca2b_4fba_88544a4c4efeacb0" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=nullCassetteArray.GetSize();
// }} ""
// {{ 886 1 0 "6629e431_e0ca_40e3_b2dc3e7c922ee1cd" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 887 1 0 "f41c0524_003f_4a40_b8e017026e990d63" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 888 1 0 "d5bd4c10_cb3d_4253_9e31d5c0be4f4cb2" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myCassette=nullCassetteArray.GetAt(myArrayIndex-1);
// }} ""
// {{ 889 1 0 "d6dab7ac_cd99_4e84_82cbe30ad3c2eedd" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myShelf=nullShelfArray.GetAt(myArrayIndex-1);
// }} ""
// {{{ 890 1 0 "227239a4_b4b1_4dd6_a9c39866f96fad43" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 891 1 0 "0200051b_df4e_4785_ab85fa7992421371" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 892 1 0 "1abdf4c0_b2be_4374_bb5ba0b580a1f769" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 893 1 0 "37fd69d3_c2a8_43c9_829bd7fa3ecf4a29" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 894 1 0 "8c6bd273_b915_4562_ab0f1e730d8c7400" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_2065D763E9B14aedB8AA55E92345B2CA ;
err.Clear();
// }} ""
// {{ 895 1 0 "47095445_35d6_4236_914017462695d420" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 896 1 0 "1e6f0915_7917_4e1f_99770bd80eda81b8" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 897 1 0 "47095445_35d6_4236_914017462695d420" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 898 1 0 "6ebe8e7b_3f3e_47e0_9c211d0629275e3f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 899 1 0 "6ebe8e7b_3f3e_47e0_9c211d0629275e3f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 900 1 0 "8c6bd273_b915_4562_ab0f1e730d8c7400" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_2065D763E9B14aedB8AA55E92345B2CA : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 901 1 0 "71e83798_0643_426d_a4fc24c429be2dfe" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Error handled by system"), Translate(""));
// }} ""
// {{ 902 1 0 "8c6bd273_b915_4562_ab0f1e730d8c7400" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 903 1 0 "f41c0524_003f_4a40_b8e017026e990d63" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 904 1 0 "5ec93b3d_dad8_490b_aed6d2b5f8cc59cc" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 905 1 0 "40b0fc00_2aff_43a7_abb6bd53eb5ad734" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 906 1 0 "1018dd84_4e05_4a2b_a117e86dd3eeec3e" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 907 1 0 "5929794a_2407_4a8e_bf0307d7d390d8d3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 908 1 0 "e6d8e3de_639e_4d65_ab339e2c901a88e2" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 909 1 0 "63d5d3e0_e1f4_4290_bf8d48e589b5d820" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 910 1 0 "40b0fc00_2aff_43a7_abb6bd53eb5ad734" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 911 1 0 "27340d22_a624_42bf_aa265de5aa122120" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 912 1 0 "1fd965c7_9541_4365_bf2b7942802b8192" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 913 1 0 "512472ad_7804_4bea_9802dd6e5c40c804" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 914 1 0 "fc7acfdd_b72f_4558_816b77f01c89f76b" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
ppSensorArray.SetSize(0);
// }} ""
// {{ 915 1 0 "d2319385_e1cb_4e70_9042bfd013ffe464" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 916 1 0 "c8161120_2445_4624_8c87fcf098e16c06" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPPSensor, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 917 1 0 "06c04dfc_204f_4736_a8ff341ee7e469f2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 918 1 0 "ab58ec91_8525_4e68_b60f7b9eeb32ff79" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 919 1 0 "4b945540_e428_45d4_b43cc090203d58d2" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 920 1 0 "ddb26348_f232_424b_af21a3a712ce1d29" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
ppSensorArray.AddAsLast(myPPSensor);
// }} ""
// {{ 921 1 0 "601b9ea3_01a4_4417_8f05f6314fe02291" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 922 1 0 "fff1c5ea_657c_4c58_8c0c2ae8d88b27c5" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 923 1 0 "81519a28_4713_4ad6_b16ec118e8c7908f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPPSensor == 1)
{
// }} ""
// {{ 924 1 0 "747542ab_28fb_4f93_a7605fa1f7acc705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_AAB1BC51211C4b18BD345CC5A39F1CAB ;
err.Clear();
// }} ""
// {{ 925 1 0 "a99ac91b_7dbd_41fe_af6868b986741386" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "<null>")
{
// }} ""
// {{ 926 1 0 "f1947fb9_ae74_4e79_88fa072507565c8f" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 927 1 0 "a99ac91b_7dbd_41fe_af6868b986741386" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 928 1 0 "fd6aaa35_6841_4f7f_96498c4cf3ce0bfb" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 929 1 0 "a99ac91b_7dbd_41fe_af6868b986741386" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 930 1 0 "747542ab_28fb_4f93_a7605fa1f7acc705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_AAB1BC51211C4b18BD345CC5A39F1CAB : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 931 1 0 "e7078206_accd_41cb_b2767a160ca8d342" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 932 1 0 "747542ab_28fb_4f93_a7605fa1f7acc705" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 933 1 0 "203a8edf_3189_42f0_b742b86d62609c36" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 934 1 0 "ded380bf_57d1_46a2_8fcff395861e09f1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 935 1 0 "10492696_f1dc_4133_bc6d6be7b119368c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 936 1 0 "2feb3825_e33a_43f6_9e68bc7049b8fd04" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 937 1 0 "9299d123_3c47_4833_96e64c85fc1dc0f6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_BAF36FD841DB4b119CDA2CA1BA82DEED ;
err.Clear();
// }} ""
// {{ 938 1 0 "59d88f17_9bb9_4b90_9bf341fad4ca5244" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 939 1 0 "4b17b340_5ad4_47bc_8eef9cf707016516" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 940 1 0 "9299d123_3c47_4833_96e64c85fc1dc0f6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_BAF36FD841DB4b119CDA2CA1BA82DEED : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 941 1 0 "9b8442e6_2795_44bd_8e7331ba01657510" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 942 1 0 "3c5ebbd8_13ea_4722_8c6e8791dbff34c0" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 943 1 0 "712758f3_b6b0_41b9_be86d42bf108845b" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("', [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 944 1 0 "0a2cd477_2a16_4ea9_bbb2ad69686f2243" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 945 1 0 "5e278fbe_08cd_45ff_9378fa0ff12baa6b" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 946 1 0 "9299d123_3c47_4833_96e64c85fc1dc0f6" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 947 1 0 "203a8edf_3189_42f0_b742b86d62609c36" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 948 1 0 "8953e4ca_d268_4a42_883709c6a08a8167" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 949 1 0 "6c4cba88_7fcd_410a_9e2ee00b78e9f957" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 950 1 0 "8f0c0701_a317_4413_8702177a4f8f9dd0" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 951 1 0 "313d44d8_cc5f_4932_b4db0945f598bf92" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 952 1 0 "203a8edf_3189_42f0_b742b86d62609c36" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 953 1 0 "81519a28_4713_4ad6_b16ec118e8c7908f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 954 1 0 "ab0d294f_715e_4a94_a6aba7239ba67b09" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 955 1 0 "e1053cab_28c6_4f43_84592f993ca06cb5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 956 1 0 "016a48a7_0ead_432f_b45b13d447244dc8" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 957 1 0 "9f696dfd_3fdb_44c1_af5f67cdd41c4a67" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 958 1 0 "81519a28_4713_4ad6_b16ec118e8c7908f" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 959 1 0 "06c04dfc_204f_4736_a8ff341ee7e469f2" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 960 1 0 "4420c9ea_35c6_41fa_88523f56639afc8d" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 961 1 0 "b948746a_370a_4147_93698a00b49bf6a2" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 962 1 0 "76dfecfa_b229_43ec_9fc0a9a577af5f88" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE BARCODE IS NOT NULL"), Translate(""));
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 963 1 0 "40245e33_3b9c_4bfc_a21c87222e69f7f6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NOT NULL AND [LiconicPartition] = '"), liconicPartition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 964 1 0 "a80a8078_4e9c_4a6b_9985bafbe2fb1a2b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 965 1 0 "898001a2_f5ab_4abe_9a62529011488005" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 966 1 0 "1ff136c1_40b4_4b39_baf0b10eaf6ae6b1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_INVENTORY_FILE.Eof() == 0)
)
{
// }} ""
// {{ 967 1 0 "2d31bfbc_d23f_42a7_a287b4138758c3d6" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 968 1 0 "4a4b4976_c991_4fea_a2f2e15a09c013c1" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retValue = Util::Lookup(barcodeInventoryArray, myBarcode, myZeroBasedIndex);
// }} ""
// {{ 969 1 0 "abc3307d_79cf_47aa_89687c00dfc70f27" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retValue == 0)
{
// }} ""
// {{ 970 1 0 "31072a2a_1b83_4da5_844ebc2b8661dded" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 971 1 0 "298476a0_391b_439f_823c98ea94055273" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 972 1 0 "5f66c95f_bcc2_470d_89f3ae5f8f3f5a73" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 973 1 0 "298476a0_391b_439f_823c98ea94055273" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 974 1 0 "abc3307d_79cf_47aa_89687c00dfc70f27" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 975 1 0 "1ff136c1_40b4_4b39_baf0b10eaf6ae6b1" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 976 1 0 "6df463ff_3bcc_4639_a20479f81122ac35" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 977 1 0 "d79196ab_aaaa_47e7_afb0a16d1f9bc668" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 978 1 0 "5afceda7_809b_4c46_a577128aa98f3ce7" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(arrayIndex = 0; arrayIndex < myArraySize;)
{
arrayIndex = arrayIndex + 1;
// }} ""
// {{ 979 1 0 "b426673a_9d95_41fe_b22c0580c8ec56da" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 980 1 0 "e8da9925_229e_4760_a6f4a68e568e5137" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL, [PlatePresent] = 0 WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 981 1 0 "ee2f7f79_16a7_4571_b5eb42af3ccfaf56" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 982 1 0 "194c2cfa_9bdb_4b24_87fc0a1d92d4118f" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 983 1 0 "5afceda7_809b_4c46_a577128aa98f3ce7" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 984 1 0 "959674d8_fbf7_46fe_b2586d80403821d3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 985 1 0 "130ed385_61d2_4270_857557f8bb823f86" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 986 1 0 "d7e13242_ad33_409f_992f75df946aa2f0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPlatesTotal != newEntry)
{
// }} ""
// {{ 987 1 0 "241ab190_d977_49e5_87fd3bddb6ca0345" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle6D5F66934F964d29BEB15F00C1F40741.SetOutput(Translate("There was a Plate Scan Discrepancy!"), Translate("\n   There where:\n\n     "), newEntry, Translate("   Barcodes Read \n\n     AND\n\n     "), myPlatesTotal, Translate("   Plates Flagged"));
dialogHandle6D5F66934F964d29BEB15F00C1F40741.ShowOutput(mySTXTitle, hslOKOnly | hslInformation | hslDefButton1, 5);
// }} ""
// {{ 988 1 0 "d7e13242_ad33_409f_992f75df946aa2f0" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 989 1 0 "8da53f6c_9c74_40ca_bfb9cef748f47a8c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Update of inventory database complete"));
// }} ""
// {{{ 990 1 0 "a4c15788_69c3_4b55_a6b61d756a71758d" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (newEntry);
// }} ""
// {{{ 5 "InventoryCarousel_PartialVariableDelay" "End"
}
// }} ""
// {{{ 5 "InventoryCarousel_PartialTrueName" "Begin"
private function InventoryCarousel_PartialTrueName( variable Partition ) variable {
// }} ""
private dialog dialogHandleDCA331ECE93D44ffBFE570E67671B719;
private dialog dialogHandle8AEABD830E984a88A9DB7261B5F90F80;
private dialog dialogHandle70F0B87A59D44ef5A6AB2DEDBDBEDD6D;
private dialog dialogHandleE3BA78A3FE6141beB024A1058C694053;
private dialog dialogHandleC33BE1F72FAD45a4A9A0BC18DA54A472;
private variable liconicPartition;
private variable shelf;
private variable PartitionTime;
private variable newEntry;
private variable myCassette;
private variable cassette;
private variable myPlatesTotal;
private variable mySTXTitle;
private variable myPlate;
private variable partitionCounter;
private variable myBarcode;
private variable myDBFileName;
private variable numOfPartitions;
private variable myInventoryFileName;
private variable loopCounterFileCheck;
private variable arrayIndex;
private variable nullBarcode;
private variable myShelf;
private variable myZeroBasedIndex;
private variable myUnitID;
private variable myInventoryFileNameCheck;
private variable stepReturn;
private variable myArraySize;
private variable myPPSensor;
private variable mySimState;
private variable retValue;
private variable myArrayIndex;
private variable myDBTableName;
private variable mySQLCommand;
private variable myStatus;
private timer PartialInventoryTimer_Unit1;
private file READ_DB_INVENTORY_FILE;
private file LICONIC_INV_FILE;
private file PARTITION_NAME_LOOKUP_FILE;
private file UPDATE_DB_INVENTORY_FILE;
private variable arrLiconicPartitions[];
private variable shelfInventoryArray[];
private variable nullCassetteArray[];
private variable barcodeToRemoveArray[];
private variable cassetteInventoryArray[];
private variable nullShelfArray[];
private variable plateInventoryArray[];
private variable ppSensorArray[];
private variable barcodeInventoryArray[];
// {{ 5 "InventoryCarousel_PartialTrueName" "InitLocals"
// }} ""
// {{ 589 1 0 "b37431d1_9a0e_4b18_926e0724f15c9d9d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************InventoryIncubator_Partial Sub**************************************"));
// }} ""
// {{{ 590 1 0 "56e99ad2_b1d9_458b_841b1e4b287cd582" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 591 1 0 "76f968d1_09db_441c_b50abb289e024025" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
PartitionTime = 120;
// }} ""
// {{ 592 1 0 "9a8d796e_37d0_4d92_a6a733b4a9ae1242" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
myInventoryFileName = Translate("C:\\LiconicTestSMT.txt");
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 593 1 0 "0f127724_05dd_48b1_af475a7802c39c25" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 594 1 0 "82dda5e4_89e0_4515_99096ccee92633fa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myInventoryFileName == myInventoryFileNameCheck)
{
// }} ""
// {{{ 595 1 0 "19509e79_795f_4244_91d089bb1865edf7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 596 1 0 "82dda5e4_89e0_4515_99096ccee92633fa" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 597 1 0 "8243c904_685c_4f17_a1cd1487553a7922" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 598 1 0 "94e86936_1fa1_4bec_b56816aadb687aa6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" started"));
// }} ""
// {{ 599 1 0 "02744fa2_82a5_4134_94fa808799622c80" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 600 1 0 "c6f4e174_5dbd_444d_b74e5232be1e43e4" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT DISTINCT [LiconicPartition] FROM ["), myDBTableName, Translate("] WHERE [Partition] = '"), Partition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 601 1 0 "dcc27ce0_b3da_4737_b7df6e64e48112e6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
PARTITION_NAME_LOOKUP_FILE.AddField("LiconicPartition", liconicPartition, hslString, 255);
if( 0 == PARTITION_NAME_LOOKUP_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 602 1 0 "90f82412_fd13_4042_a45fc1b9cca9297c" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
arrLiconicPartitions.SetSize(0);
// }} ""
// {{ 603 1 0 "374fb38b_3e21_42ed_94c56a355309cb27" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
arrLiconicPartitions.AddAsLast(Partition);
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 604 1 0 "3cfe6854_ddad_475e_b3ec090b2a8e27f9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (PARTITION_NAME_LOOKUP_FILE.Eof() == 0)
)
{
// }} ""
// {{ 605 1 0 "48d5dad8_f33e_46f5_b3233c8bc58630a4" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PARTITION_NAME_LOOKUP_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 606 1 0 "e8c55e50_2a40_4549_80b89238fa27c86c" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
arrLiconicPartitions.AddAsLast(liconicPartition);
// }} ""
// {{{ 607 1 0 "dbc700c2_65ed_4733_85af25fb8b178385" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Liconic Partition to scan:  "), liconicPartition);
// }} ""
// {{ 608 1 0 "3cfe6854_ddad_475e_b3ec090b2a8e27f9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 609 1 0 "b50a03fd_23b3_4199_aa53337814ba3b82" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != PARTITION_NAME_LOOKUP_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
PARTITION_NAME_LOOKUP_FILE.RemoveFields();
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 610 1 0 "9cd7e70a_7764_4d7a_9c3189bf049a26a8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{ 611 1 0 "22d691be_89aa_4584_9e12e4bdb35b3857" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
numOfPartitions=arrLiconicPartitions.GetSize();
// }} ""
// {{ 612 1 0 "dbd6b950_3329_4855_adbe26594d244d5c" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(partitionCounter = 0; partitionCounter < numOfPartitions;)
{
partitionCounter = partitionCounter + 1;
// }} ""
// {{{ 613 1 0 "55495356_9931_49a8_a3f72abeb8f0dfd6" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
HSLMapReport::DeleteFile(myInventoryFileName);
// }} ""
// {{ 614 1 0 "10ebaf0d_3423_4ebc_8f4275a1f2b1a42e" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
liconicPartition=arrLiconicPartitions.GetAt(partitionCounter-1);
// }} ""
// {{ 615 1 0 "582378ac_9d44_4e5f_a5f1e2f0562457ab" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle8AEABD830E984a88A9DB7261B5F90F80.SetOutput(Translate("Liconic Partition to scan:  "), liconicPartition);
dialogHandle8AEABD830E984a88A9DB7261B5F90F80.ShowOutput("", hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{{ 616 1 0 "fd34349f_7594_4b64_8753e35cd049fdd7" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
stepReturn = HSLLiconicSTX::COMMAND::PartialInventoryScan(myUnitID, myInventoryFileName, liconicPartition, 1, 1);
// }} ""
// {{ 617 1 0 "4bc0d516_cd2a_482a_b9ca5582b7bdd75f" "{B31F353E-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.SetTimer(PartitionTime) )
{
    MECC::RaiseRuntimeErrorEx(-1355939584, MECC::IDS::stepNameTimerStart, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 618 1 0 "016f59f5_2bf8_4000_8c8eb54d594e9f8d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (stepReturn == HSLLiconicSTX::FALSE)
{
// }} ""
// {{ 619 1 0 "d6e9595e_aef7_4e29_8a5640c013a69138" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleC33BE1F72FAD45a4A9A0BC18DA54A472.SetOutput(Translate("The incubator returned an error!\n\nPlease check logfile for details."));
dialogHandleC33BE1F72FAD45a4A9A0BC18DA54A472.ShowOutput(Translate("Incubator Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 620 1 0 "5cd1f2e1_2dc6_43e1_86181cea3a332e8b" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 621 1 0 "016f59f5_2bf8_4000_8c8eb54d594e9f8d" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 622 1 0 "951d510b_495f_4c04_a31c7288d09354e7" "{B31F353F-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == PartialInventoryTimer_Unit1.WaitTimer(hslTrue, hslTrue) )
{
    MECC::RaiseRuntimeErrorEx(-1339162368, MECC::IDS::stepNameTimerWait, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 623 1 0 "f8d6376b_7764_414c_87ec75ddca8cd869" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 624 1 0 "33de987c_03f0_4f6e_82a9c2e60de3a7a9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
loopCounterFileCheck = 0;
while (myInventoryFileName != myInventoryFileNameCheck)
{
loopCounterFileCheck = loopCounterFileCheck + 1;
// }} ""
// {{ 625 1 0 "5879ad52_98b2_4d6d_8b0416c0b10c7d49" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 200)
{
// }} ""
// {{ 626 1 0 "3cdbf488_e879_4081_b3ce121f5044f0c2" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandle70F0B87A59D44ef5A6AB2DEDBDBEDD6D.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not completing.... \n\n\n ABORT and run again......"));
dialogHandle70F0B87A59D44ef5A6AB2DEDBDBEDD6D.ShowOutput(Translate("STX220 Invenoty Write File Error"), hslOKOnly | hslInformation | hslDefButton1, hslInfinite);
// }} ""
// {{ 627 1 0 "e7035dc2_e77f_46fd_8cc0fc518b114224" "{930D6C31-8EFB-11d4-A3BA-002035848439}"
abort;
// }} ""
// {{ 628 1 0 "5879ad52_98b2_4d6d_8b0416c0b10c7d49" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 629 1 0 "007f168a_ee1b_4825_b8362bf5692327c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (loopCounterFileCheck > 20)
{
// }} ""
// {{ 630 1 0 "03ac8c0a_a5c7_46e2_b378f1dfd8040672" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleDCA331ECE93D44ffBFE570E67671B719.SetOutput(Translate("STX220 Invenoty of "), Partition, Translate(" is not complete.... \n\n\n Delay 20 sec......"));
dialogHandleDCA331ECE93D44ffBFE570E67671B719.ShowOutput(Translate("STX220 Invenoty Delay "), hslOKOnly | hslInformation | hslDefButton1, 20);
// }} ""
// {{ 631 1 0 "007f168a_ee1b_4825_b8362bf5692327c5" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 632 1 0 "5879ad52_98b2_4d6d_8b0416c0b10c7d49" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 633 1 0 "f4406995_c3e3_4543_abfde006e3d6ff34" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
myInventoryFileNameCheck = FilSearchPath(myInventoryFileName);
// }} ""
// {{ 634 1 0 "33de987c_03f0_4f6e_82a9c2e60de3a7a9" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{{ 635 1 0 "f4306888_850f_4195_8c275d8311ba30fc" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
CheckLiconicStatus();
// }} ""
// {{{ 636 1 0 "f269bc34_9073_43b0_a07d921374af3c3e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace4(mySTXTitle, Translate("Partial inventory of partition "), Partition, Translate(" complete"));
// }} ""
// {{{ 637 1 0 "589ca6c2_9ede_4a82_8a1bb8586131bac0" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Start update of inventory database"));
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 638 1 0 "154de1d2_3841_4123_9c5692ee41df9c1d" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 639 1 0 "3417c2c0_b8a6_408a_bb5b97be6668b3e6" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 640 1 0 "def2d776_a2f7_4734_95ffa23c1e5bf120" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 641 1 0 "7f87df1a_abae_48c0_a17ac60ce4611dc7" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 642 1 0 "efef4059_015b_4757_b71a48d2a9994a7a" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
plateInventoryArray.SetSize(0);
// }} ""
// {{ 643 1 0 "050775e7_2554_4276_9d45159199796b67" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPlate, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 644 1 0 "1e3f46b7_a17a_4e39_b7d1b4a15529bcc3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 645 1 0 "e71e4eac_2aaa_4865_a413d254bfdb1e34" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 646 1 0 "8f8d05f0_1f36_4e04_94687bdedcf1811f" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 647 1 0 "ec6d9fca_21b3_4a61_8fa3ca19685a7bfc" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 648 1 0 "9c008b67_ab63_4382_aee78a5a245ba047" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 649 1 0 "8d281508_b661_4ae3_9191f115cd9b24b6" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 650 1 0 "f01ef659_6dac_4d0f_84ed3b3cfb65096e" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullCassetteArray.SetSize(0);
// }} ""
// {{ 651 1 0 "8fb0d2fd_d127_4829_a16f6757bc00738d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
plateInventoryArray.AddAsLast(myPlate);
// }} ""
// {{ 652 1 0 "0c46a4b8_1203_4f17_88c126e806d58669" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
nullShelfArray.SetSize(0);
// }} ""
// {{ 653 1 0 "fea1ebb7_6314_4d88_9177544f54d7a323" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
myPlatesTotal = myPlatesTotal + myPlate;
// }} ""
// {{ 654 1 0 "57b9451e_1460_4ea6_928dfb489e711af2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_84A0986D51394247A0A0032B99F3E7E4 ;
err.Clear();
// }} ""
// {{ 655 1 0 "f47aa30b_1633_478e_9885869be7ae94e7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 656 1 0 "07e93687_c3d9_4030_b2e08a23a89a99b2" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 657 1 0 "f47aa30b_1633_478e_9885869be7ae94e7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 658 1 0 "ad1f01c0_9f6d_43f2_8f88a60df0d26de9" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 659 1 0 "f47aa30b_1633_478e_9885869be7ae94e7" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 660 1 0 "57b9451e_1460_4ea6_928dfb489e711af2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_84A0986D51394247A0A0032B99F3E7E4 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 661 1 0 "1f0f4981_e175_43df_813b2ef7218c32a8" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 662 1 0 "57b9451e_1460_4ea6_928dfb489e711af2" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 663 1 0 "28b99610_8ab9_4368_96e6af8de185bdec" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 664 1 0 "5623989f_c272_45a5_be60254e73ae6776" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 665 1 0 "ebb2bdfe_439c_45e7_90ab3620e73af8b8" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 666 1 0 "4a1a6449_22bb_4097_a7beb9806ad44c76" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 667 1 0 "de46f803_42c0_4a2f_9c94cd3d0bfcd825" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_9008F30EAB914d66993D547C1EB3E39D ;
err.Clear();
// }} ""
// {{ 668 1 0 "41bd3f35_e5fd_4925_89ed2138f7c15579" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 669 1 0 "2ca1913a_5bf8_495c_baad62623309b6c1" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 670 1 0 "de46f803_42c0_4a2f_9c94cd3d0bfcd825" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_9008F30EAB914d66993D547C1EB3E39D : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 671 1 0 "e424f9b6_0a8d_4dc1_bb3fd7e5e716c01c" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 672 1 0 "462536b8_b304_46ff_97caace64981be93" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 673 1 0 "096a7609_70f6_41b9_88233bebd655340c" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("' , [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 674 1 0 "5fcaf883_a2de_4c00_9374c293e96630b0" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 675 1 0 "5ae60313_32fc_4dd9_afd45de31816b81e" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 676 1 0 "c0e44db2_3ab3_40a6_82ed6a7067c84b53" "{B31F3544-5D80-11d4-A5EB-0050DA737D89}"
newEntry = newEntry + 1;
// }} ""
// {{ 677 1 0 "de46f803_42c0_4a2f_9c94cd3d0bfcd825" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 678 1 0 "28b99610_8ab9_4368_96e6af8de185bdec" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 679 1 0 "8b1cd5cc_1e58_45de_989ed9c0506804b6" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullCassetteArray.AddAsLast(myCassette);
// }} ""
// {{ 680 1 0 "45b9f485_a2f6_4309_9c3f86efa9a95a41" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
nullShelfArray.AddAsLast(myShelf);
// }} ""
// {{ 681 1 0 "28b99610_8ab9_4368_96e6af8de185bdec" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 682 1 0 "1e3f46b7_a17a_4e39_b7d1b4a15529bcc3" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 683 1 0 "cf6624fd_eb1d_45ea_ab36541d7e944aea" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 684 1 0 "fee321d3_04be_423c_9c7427e2eba153ce" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 685 1 0 "76ff9c3a_8202_417e_8b0295984ae5a072" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=nullCassetteArray.GetSize();
// }} ""
// {{ 686 1 0 "1e3bf837_4c1a_4532_9ab5c8d2cc6ade0f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 687 1 0 "0c49e74d_80ea_4e60_91338440998944a4" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 688 1 0 "be753ee7_eec4_452b_af9d31b96c1afa1c" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myCassette=nullCassetteArray.GetAt(myArrayIndex-1);
// }} ""
// {{ 689 1 0 "e1c0eefc_3dc5_4873_852b149354b3b050" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myShelf=nullShelfArray.GetAt(myArrayIndex-1);
// }} ""
// {{{ 690 1 0 "aeef9115_90f8_45e6_95ce910b87936b63" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 691 1 0 "e479d65c_3659_4098_a0a29661746c0cb8" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 692 1 0 "b6e54176_276e_4b87_969406789d406c76" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 693 1 0 "96cf458c_a244_46a5_a36ad5f536568318" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 694 1 0 "c550cb6a_e882_47e8_a36eca5bad6ba1ba" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_D2EBCBE3EE514d328701E91AD267445C ;
err.Clear();
// }} ""
// {{ 695 1 0 "09fb3ca2_af29_4435_82ef5dca4d27191a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 696 1 0 "10094c47_f0af_4b7e_b040bb4c6d82afd6" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 697 1 0 "09fb3ca2_af29_4435_82ef5dca4d27191a" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 698 1 0 "7f3d22c9_423a_464a_933e49388d722d02" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "")
{
// }} ""
// {{ 699 1 0 "7f3d22c9_423a_464a_933e49388d722d02" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 700 1 0 "c550cb6a_e882_47e8_a36eca5bad6ba1ba" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_D2EBCBE3EE514d328701E91AD267445C : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{{ 701 1 0 "f75431b8_40cc_4c41_a2efb157a178734f" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(Translate("Error handled by system"), Translate(""));
// }} ""
// {{ 702 1 0 "c550cb6a_e882_47e8_a36eca5bad6ba1ba" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 703 1 0 "0c49e74d_80ea_4e60_91338440998944a4" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 704 1 0 "d41856f5_69e7_4849_ab0c53d4cec8e3b7" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 705 1 0 "15ace1f6_f38f_4eff_b29eef5556071624" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(myArrayIndex = 0; myArrayIndex < myArraySize;)
{
myArrayIndex = myArrayIndex + 1;
// }} ""
// {{ 706 1 0 "2cbc14f0_9a7c_4614_b5c8fd2a7ca2357c" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 707 1 0 "a23d146e_2911_466e_b74c80cbca764f76" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 708 1 0 "80869196_ddb4_46a8_8bd36030b451e959" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 709 1 0 "c0d852e4_580d_4b96_80d21815ec94eb58" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 710 1 0 "15ace1f6_f38f_4eff_b29eef5556071624" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{ 711 1 0 "0ebaba79_83b0_4275_b7a121e1d3dc78c7" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 712 1 0 "c8c6d65e_3477_40e7_8e5297c015084817" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
cassetteInventoryArray.SetSize(0);
// }} ""
// {{ 713 1 0 "d02da825_86ba_4b25_aca497790253907c" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
shelfInventoryArray.SetSize(0);
// }} ""
// {{ 714 1 0 "67f7fff2_2363_47db_a47797d221f7133f" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
ppSensorArray.SetSize(0);
// }} ""
// {{ 715 1 0 "fc4828b8_69c3_4faf_90fa7fc49ec8ebab" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeInventoryArray.SetSize(0);
// }} ""
// {{ 716 1 0 "84f78296_0d0c_457a_ab77db2b19c66a44" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
LICONIC_INV_FILE.AddField(1, myBarcode, hslString, 255);
LICONIC_INV_FILE.AddField(4, myPPSensor, hslInteger);
LICONIC_INV_FILE.AddField(8, myCassette, hslString, 255);
LICONIC_INV_FILE.AddField(9, myShelf, hslString, 255);
LICONIC_INV_FILE.SetDelimiter(hslCSVDelimited);
if( 0 == LICONIC_INV_FILE.Open(myInventoryFileName, hslRead) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myInventoryFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 717 1 0 "aa08176b_06fc_445f_a7344f4d4dbf8238" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (LICONIC_INV_FILE.Eof() == 0)
)
{
// }} ""
// {{ 718 1 0 "48d58282_a19f_424f_9e05b202796633a5" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == LICONIC_INV_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 719 1 0 "40c84437_126d_45c2_b5d9b282e5f3bb2d" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeInventoryArray.AddAsLast(myBarcode);
// }} ""
// {{ 720 1 0 "5ac659d9_e4a0_4436_b71e88bbb5e0b269" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
ppSensorArray.AddAsLast(myPPSensor);
// }} ""
// {{ 721 1 0 "566b9508_2e54_4f44_918cbd61ea9a9f27" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
cassetteInventoryArray.AddAsLast(myCassette);
// }} ""
// {{ 722 1 0 "fde8824b_0ed1_4c6b_923d315d5c42d3e8" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
shelfInventoryArray.AddAsLast(myShelf);
// }} ""
// {{ 723 1 0 "8d4417c3_de34_42ed_83c68eb841bd6685" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPPSensor == 1)
{
// }} ""
// {{ 724 1 0 "c7df5d58_cddf_4106_b62767998e498b03" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_89F41F3FB10E4f8c8EE921F23404FF0C ;
err.Clear();
// }} ""
// {{ 725 1 0 "2d375e08_780a_4815_b3f3584d78a9e529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myBarcode != "<null>")
{
// }} ""
// {{ 726 1 0 "fc6059d6_51b8_40bc_930ec66e9a50edee" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 0;
// }} ""
// {{ 727 1 0 "2d375e08_780a_4815_b3f3584d78a9e529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 728 1 0 "14de1dbd_059f_4081_a5da9df550e01351" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 729 1 0 "2d375e08_780a_4815_b3f3584d78a9e529" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 730 1 0 "c7df5d58_cddf_4106_b62767998e498b03" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_89F41F3FB10E4f8c8EE921F23404FF0C : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 731 1 0 "0f7ac7f8_f994_4999_8f89293f0ae66945" "{B31F3543-5D80-11d4-A5EB-0050DA737D89}"
nullBarcode = 1;
// }} ""
// {{ 732 1 0 "c7df5d58_cddf_4106_b62767998e498b03" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 733 1 0 "4ea57cde_a424_4097_8e28a51936637179" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (nullBarcode == 0)
{
// }} ""
// {{ 734 1 0 "6b620fee_fd10_44ab_b30156f304fcbfa0" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 735 1 0 "f9857d4d_fd71_4811_a19ecc104cf0bfac" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 736 1 0 "bf73ce0a_657d_4fdd_91cf01d3031cbf57" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", cassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", shelf, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 737 1 0 "a6469fab_5fb0_4bee_ba66d6a4f5c58205" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
onerror goto errLabel_A4CD0A9F120242bf863FAB8BE2E09634 ;
err.Clear();
// }} ""
// {{ 738 1 0 "f02e45d2_3922_4cd2_b77e36d17cb0e63d" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{ 739 1 0 "ba2ae2e4_9286_47a8_b7e980646c17f979" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 740 1 0 "a6469fab_5fb0_4bee_ba66d6a4f5c58205" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
errLabel_A4CD0A9F120242bf863FAB8BE2E09634 : {}
onerror goto 0;
if (err.GetId() != 0)   /* skip handler if no error */
{
// }} ""
// {{ 741 1 0 "88f19fdc_89d0_4541_8fcef895d2ed62ee" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 742 1 0 "e8588b90_2676_4d62_baca4f36ca3430e3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{{ 743 1 0 "a7f80bcb_b909_4fd9_8606ba9cc85ef013" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), myBarcode, Translate("', [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""));
// }} ""
// {{ 744 1 0 "e7f0f28f_2386_4c8e_bda53b5ed33fe84b" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 745 1 0 "45db9587_a2ac_440c_8af1d377bfe4f351" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 746 1 0 "a6469fab_5fb0_4bee_ba66d6a4f5c58205" "{3293659E-F71E-472f-AFB4-6A674E32B114}"
}   /* end if from skip handler if no error */
// }} ""
// {{ 747 1 0 "4ea57cde_a424_4097_8e28a51936637179" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 748 1 0 "9e628ccd_5356_4dab_a01338d681bd48ce" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 749 1 0 "4569e39c_0284_43e5_b92dd973704642fa" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 750 1 0 "d48a9e78_4019_4e6e_aead15c21a7fdf4c" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 751 1 0 "e87bc979_9918_4f51_8840dc7930c24e27" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 752 1 0 "4ea57cde_a424_4097_8e28a51936637179" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 753 1 0 "8d4417c3_de34_42ed_83c68eb841bd6685" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
else
{
// }} ""
// {{ 754 1 0 "81867efc_c962_4a31_baa44a07495988aa" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{{ 755 1 0 "83af3307_53e5_4508_87a61885eb81c6ef" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL, [PlatePresent] = "), myPPSensor, Translate(", [Status] = 'INCUBATOR' WHERE [Cassette] = '"), myCassette, Translate("' AND [Shelf] = '"), myShelf, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 756 1 0 "458baa20_0398_4de0_bf7818ded9f53568" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 757 1 0 "a899e631_d463_4fff_af65ca2d87f25a8a" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 758 1 0 "8d4417c3_de34_42ed_83c68eb841bd6685" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 759 1 0 "aa08176b_06fc_445f_a7344f4d4dbf8238" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 760 1 0 "1c635da4_33dc_45b8_a5d3aabd77094830" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != LICONIC_INV_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
LICONIC_INV_FILE.RemoveFields();
// }} ""
// {{ 761 1 0 "480aafda_6d37_4e9b_8d0da205b3a9caaa" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{{ 762 1 0 "db525a52_60a3_4755_8367971e3bcb98c3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat4(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE BARCODE IS NOT NULL"), Translate(""));
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 763 1 0 "a29a5d95_a438_42bc_8c087e1d20499a32" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("SELECT * FROM ["), myDBTableName, Translate("] WHERE [Barcode] IS NOT NULL AND [LiconicPartition] = '"), liconicPartition, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 764 1 0 "8744f9ae_7f65_4273_adf2db6d799c79a6" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
READ_DB_INVENTORY_FILE.AddField("Cassette", myCassette, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Shelf", myShelf, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Barcode", myBarcode, hslString, 255);
READ_DB_INVENTORY_FILE.AddField("Status", myStatus, hslString, 255);
if( 0 == READ_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslRead, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 765 1 0 "eba5aad6_0f9e_478a_aa6429e45dcc8d9b" "{4900C1F7-0FB7-4033-8253-760BDB9354DC}"
barcodeToRemoveArray.SetSize(0);
// }} ""
// {{ 766 1 0 "cbe56c29_c953_4c55_b14a9fae38fa5e63" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
while (
   (READ_DB_INVENTORY_FILE.Eof() == 0)
)
{
// }} ""
// {{ 767 1 0 "3eee27a9_ba2f_4d80_922becdb5a84073f" "{B31F3536-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == READ_DB_INVENTORY_FILE.ReadRecord() )
{
    MECC::RaiseRuntimeErrorEx(-1490157312, MECC::IDS::stepNameFileRead, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
// }} ""
// {{{ 768 1 0 "f6b53dd0_2a63_41c9_95a80f460775f53e" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
retValue = Util::Lookup(barcodeInventoryArray, myBarcode, myZeroBasedIndex);
// }} ""
// {{ 769 1 0 "7af55993_eea5_4316_859a077e9428c6c4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (retValue == 0)
{
// }} ""
// {{ 770 1 0 "1b17800f_454c_4b31_8db6f6f1fd92315b" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 771 1 0 "3c108dee_f20d_47db_ba8f950ff4032ebb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myStatus != "STAR_DECK")
{
// }} ""
// {{ 772 1 0 "d6b317e5_977c_4105_bde62f2e4fd065d7" "{F17B7626-27CB-47f1-8477-8C4158339A6D}"
barcodeToRemoveArray.AddAsLast(myBarcode);
// }} ""
// {{ 773 1 0 "3c108dee_f20d_47db_ba8f950ff4032ebb" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 774 1 0 "7af55993_eea5_4316_859a077e9428c6c4" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{ 775 1 0 "cbe56c29_c953_4c55_b14a9fae38fa5e63" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 776 1 0 "a4633513_6f93_48d4_b9e10b74fb9bcb09" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != READ_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
READ_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 777 1 0 "e942213e_24cb_4acc_bc17fe8bb3cb8f45" "{72EACF88-8D49-43e3-92C8-2F90E81E3260}"
myArraySize=barcodeToRemoveArray.GetSize();
// }} ""
// {{ 778 1 0 "1d0f4cf2_ea0d_4005_9bf991b9119d15bb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
{
for(arrayIndex = 0; arrayIndex < myArraySize;)
{
arrayIndex = arrayIndex + 1;
// }} ""
// {{ 779 1 0 "9cd3bcd0_ebb6_461f_bed599916e45cba1" "{67A8F1C9-6546-41e9-AD2F-3C54F7818853}"
myBarcode=barcodeToRemoveArray.GetAt(arrayIndex-1);
// }} ""
// {{{ 780 1 0 "bb026b31_87b8_4cfe_90bdabd519c9ae28" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat8(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = NULL , [Status] = NULL, [PlatePresent] = 0 WHERE [Barcode] = '"), myBarcode, Translate("'"), Translate(""), Translate(""), Translate(""));
// }} ""
// {{ 781 1 0 "baa287b4_dd8e_4309_a609059a6996158a" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == UPDATE_DB_INVENTORY_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 782 1 0 "7ecd48c6_5802_43ab_9ee9c46e1312b6a3" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != UPDATE_DB_INVENTORY_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
UPDATE_DB_INVENTORY_FILE.RemoveFields();
// }} ""
// {{ 783 1 0 "1d0f4cf2_ea0d_4005_9bf991b9119d15bb" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 784 1 0 "dbd6b950_3329_4855_adbe26594d244d5c" "{B31F3532-5D80-11d4-A5EB-0050DA737D89}"
}
}
// }} ""
// {{ 785 1 0 "9cd7e70a_7764_4d7a_9c3189bf049a26a8" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "0" */ if(0){  /* }} "" */
// {{ 786 1 0 "23b00015_886b_410f_915387f7baf52b64" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (myPlatesTotal != newEntry)
{
// }} ""
// {{ 787 1 0 "acbbab5c_7e1f_4494_849caadcce37ced1" "{21E07B31-8D2E-11d4-A3B8-002035848439}"
dialogHandleE3BA78A3FE6141beB024A1058C694053.SetOutput(Translate("There was a Plate Scan Discrepancy!"), Translate("\n   There where:\n\n     "), newEntry, Translate("   Barcodes Read \n\n     AND\n\n     "), myPlatesTotal, Translate("   Plates Flagged"));
dialogHandleE3BA78A3FE6141beB024A1058C694053.ShowOutput(mySTXTitle, hslOKOnly | hslInformation | hslDefButton1, 5);
// }} ""
// {{ 788 1 0 "23b00015_886b_410f_915387f7baf52b64" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
/* {{ 1 "" "1" */ } /* }} "" */
// {{{ 789 1 0 "f21e0350_24aa_4ac3_bf302ea85788cd52" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace(mySTXTitle, Translate("Update of inventory database complete"));
// }} ""
// {{{ 790 1 0 "63958b70_3547_4f57_9afec2ff27236cda" "{9EC997CD-FD3B-4280-811B-49E99DCF062C}"
return (newEntry);
// }} ""
// {{{ 5 "InventoryCarousel_PartialTrueName" "End"
}
// }} ""
// {{{ 5 "UpdateDatabaseFromArrays" "Begin"
function UpdateDatabaseFromArrays( variable iStackNumber, variable iPositionInStack, variable iBarcode, variable iPlateOccupancy ) void {
// }} ""
private dialog dialogHandleB6C2F75958A04c32A94FC31800A9433D;
private dialog dialogHandle91E1C634B94B4550BD6B839F4DF45F15;
private dialog dialogHandle67427057CFAA49ff80CEA82BF2B146FA;
private dialog dialogHandle51324E63CF0E472a8BDE57DB8AC5853E;
private dialog dialogHandle45074A0BF49245698E3DB4DC45EE293B;
private dialog dialogHandle38369F7835754bd696304B6326E7A217;
private dialog dialogHandle7E1E301FA5164cf4B79E1BE6B7763A5C;
private variable retVal;
private variable myCassette;
private variable tmpBarcode;
private variable dlgReturn;
private variable mySTXTitle;
private variable myDBFileName;
private variable loopCounter1;
private variable myShelf;
private variable stepReturn;
private variable myUnitID;
private variable level;
private variable fileReadCounter;
private variable mySimState;
private variable myDBTableName;
private variable mySQLCommand;
private variable slot;
private variable retval;
private file DB_UPDATE_FILE;
private file DB_LOOKUP_FILE;
// {{ 5 "UpdateDatabaseFromArrays" "InitLocals"
// }} ""
// {{ 1248 1 0 "6c89efba_7abc_491d_bbc09ec10bf2c5e1" "{F07B0071-8EFC-11d4-A3BA-002035848439}"
MECC::TraceComment(Translate("**********************************STX MANAGER SMT**************************************\n**********************************UpdateDatabaseFromArrays Sub**************************************"));
// }} ""
// {{{ 1249 1 0 "b854304a_32dd_4798_9a20b9ca8f6f09bf" "{7C4EF7A7-39BE-406a-897F-71F3A35B4093}"
Definitions(myDBFileName, myDBTableName, myUnitID, mySTXTitle, mySimState);
// }} ""
// {{ 1250 1 0 "ad340120_c255_48b2_95e14b5f1a03d295" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
if (mySimState != 1)
{
// }} ""
// {{{ 1251 1 0 "4ae7255c_637f_4a78_a2f1d3347f5861c3" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
mySQLCommand = StrConcat12(Translate("UPDATE ["), myDBTableName, Translate("] SET [Barcode] = '"), iBarcode, Translate("', [PlatePresent] = '"), iPlateOccupancy, Translate("', [Status] = 'INCUBATOR' WHERE [Cassette] = '"), iStackNumber, Translate("' AND [Shelf] = '"), iPositionInStack, Translate("'"), Translate(""));
// }} ""
// {{ 1252 1 0 "10e188dd_5827_46cd_b4c0ee8b450fd9a3" "{F07B0071-8EFC-11d4-A3BA-002035848439}"

// }} ""
// {{ 1253 1 0 "12ed41a1_f7f0_4410_90f7fc29c5f54fd7" "{B31F3534-5D80-11d4-A5EB-0050DA737D89}"
if( 0 == DB_UPDATE_FILE.Open(myDBFileName + " " + myDBTableName, hslAppend, mySQLCommand) )
{
    MECC::RaiseRuntimeErrorEx(-1523711743, MECC::IDS::stepNameFileOpen, MECC::IDS::errorStepFileOpenFailed, myDBFileName, "HxMetEdCompCmd");
}
// }} ""
// {{ 1254 1 0 "4049ee44_7961_477a_a44972a2203a65e2" "{B31F3538-5D80-11d4-A5EB-0050DA737D89}"
if( 0 != DB_UPDATE_FILE.Close() )
{
    MECC::RaiseRuntimeErrorEx(-1456602880, MECC::IDS::stepNameFileClose, MECC::IDS::errorStepFailed, "", "HxMetEdCompCmd");
}
DB_UPDATE_FILE.RemoveFields();
// }} ""
// {{{ 1255 1 0 "2e13ed9d_4063_4ae1_b99d4f83d5e885b5" "{C1F3C015-47B3-4514-9407-AC2E65043419}"
TrcTrace12(mySTXTitle, Translate("Plate "), iBarcode, Translate(", occupancy "), iPlateOccupancy, Translate(", stored in cassette "), iStackNumber, Translate(", shelf "), iPositionInStack, Translate(" succesfully"), Translate(""), Translate(""));
// }} ""
// {{ 1256 1 0 "ad340120_c255_48b2_95e14b5f1a03d295" "{B31F3531-5D80-11d4-A5EB-0050DA737D89}"
}
// }} ""
// {{{ 5 "UpdateDatabaseFromArrays" "End"
}
// }} ""
/* {{ 2 "SubmethodInsertLine" "" */ // }} ""
// {{{ 2 "LibraryNamespace" "End"
} // library namespace
// }} ""
// $$author=ch33$$valid=0$$time=2022-11-01 17:37$$checksum=7525a1fe$$length=083$$